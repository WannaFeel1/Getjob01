<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Âú®Âú∞Âπ´Âπ´Â∑•ÔΩú‡∏ä‡πà‡∏ß‡∏¢‡∏´‡∏≤‡∏á‡∏≤‡∏ô‡∏ä‡πà‡∏ß‡∏¢‡∏´‡∏≤‡∏Ñ‡∏ô - Local Worker Connect</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wght@300;400;500;600;700&family=Noto+Sans+SC:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { font-family: 'Noto Sans Thai', 'Noto Sans SC', sans-serif; }
        .bg-primary { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .bg-secondary { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); }
        .text-primary { color: #667eea; }
        .border-primary { border-color: #667eea; }
        .hover-primary:hover { background: linear-gradient(135deg, #5a6fd8 0%, #6a4190 100%); }
        .fade-in { animation: fadeIn 0.8s ease-in; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
        .card-hover:hover { transform: translateY(-5px); box-shadow: 0 15px 35px rgba(0,0,0,0.1); }
        .loading { animation: spin 1s linear infinite; }
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        .pulse-dot { animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        .connection-status { transition: all 0.3s ease; }
        .status-online { color: #10b981; }
        .status-offline { color: #ef4444; }
        .status-checking { color: #f59e0b; }
        .hero-icon { font-size: 8rem; margin-bottom: 2rem; }
        .main-title { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 via-white to-purple-50 min-h-screen">
    <!-- Language Toggle - Bottom Right -->
    <div class="fixed bottom-6 right-6 z-50">
        <button id="langToggle" class="bg-primary text-white px-6 py-3 rounded-full hover-primary transition-all duration-300 shadow-xl flex items-center space-x-2">
            <span class="text-xl">üåê</span>
            <span id="langText" class="font-medium">‰∏≠Êñá</span>
        </button>
    </div>



    <!-- Landing Page -->
    <div id="landingPage" class="min-h-screen flex items-center justify-center relative overflow-hidden">
        <!-- Background Pattern -->
        <div class="absolute inset-0 opacity-5">
            <div class="absolute top-10 left-10 w-20 h-20 bg-purple-500 rounded-full"></div>
            <div class="absolute top-40 right-20 w-16 h-16 bg-blue-500 rounded-full"></div>
            <div class="absolute bottom-20 left-20 w-24 h-24 bg-pink-500 rounded-full"></div>
            <div class="absolute bottom-40 right-10 w-12 h-12 bg-indigo-500 rounded-full"></div>
        </div>
        
        <div class="text-center fade-in relative z-10 max-w-4xl mx-auto px-6">
            <!-- Hero Icon Placeholder -->
            <div class="hero-icon mb-8">
                <div class="w-40 h-40 mx-auto bg-gradient-to-br from-blue-100 to-purple-100 rounded-3xl flex items-center justify-center shadow-2xl">
                    <img src="56907.jpg" alt="‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û" class="w-full h-full object-cover">
                </div>
            </div>
            
            <!-- Main Title -->
            <div class="mb-12">
                <h1 class="text-5xl md:text-7xl font-bold main-title mb-6 leading-tight">
                    <span id="titleChinese">Âú®Âú∞Âπ´Âπ´Â∑•</span>
                </h1>
                <h2 class="text-3xl md:text-4xl font-semibold text-gray-600 mb-4">
                    <span id="titleThai">‡∏ä‡πà‡∏ß‡∏¢‡∏´‡∏≤‡∏á‡∏≤‡∏ô‡∏ä‡πà‡∏ß‡∏¢‡∏´‡∏≤‡∏Ñ‡∏ô</span>
                </h2>
                <p class="text-xl text-gray-500 font-light" id="subtitle">Local Worker Connect Platform</p>
            </div>
            
            <!-- Action Buttons -->
            <div class="flex flex-col sm:flex-row gap-4 justify-center items‡∏ü-center">
                <button id="startBtn" class="bg-primary text-white px-10 py-4 rounded-2xl text-xl font-semibold hover-primary transition-all duration-300 shadow-xl transform hover:scale-105 flex items-center space-x-3">
                    <span class="text-2xl">üöÄ</span>
                    <span id="startBtnText">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</span>
                </button>
                <button id="aboutBtn" class="bg-white text-gray-700 px-10 py-4 rounded-2xl text-xl font-semibold hover:bg-gray-50 transition-all duration-300 shadow-lg border-2 border-gray-200 flex items-center space-x-3">
                    <span class="text-2xl">‚ÑπÔ∏è</span>
                    <span id="aboutBtnText">‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÄ‡∏£‡∏≤</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Main System -->
    <div id="mainSystem" class="hidden">
        <!-- Navigation -->
        <nav class="bg-primary text-white shadow-lg">
            <div class="container mx-auto px-4 py-4">
                <div class="flex justify-between items-center">
                    <h1 class="text-xl font-bold" id="navTitle">‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô</h1>
                    <div class="flex space-x-4">
                        <button id="addWorkerBtn" class="bg-white text-primary px-4 py-2 rounded hover:bg-gray-100 transition-colors">
                            <span id="addWorkerText">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</span>
                        </button>
                        <button id="adminBtn" class="bg-yellow-500 text-white px-4 py-2 rounded hover:bg-yellow-600 transition-colors">
                            <span id="adminText">‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö</span>
                        </button>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Search and Filter Section -->
        <div class="container mx-auto px-4 py-6">
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <h3 class="text-lg font-semibold mb-4" id="searchTitle">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÅ‡∏•‡∏∞‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h3>
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                    <input type="text" id="searchInput" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏´‡∏±‡∏™‡∏á‡∏≤‡∏ô" class="border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:border-primary">
                    <select id="genderFilter" class="border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:border-primary">
                        <option value="">‡∏ó‡∏∏‡∏Å‡πÄ‡∏û‡∏®</option>
                        <option value="‡∏ä‡∏≤‡∏¢">‡∏ä‡∏≤‡∏¢</option>
                        <option value="‡∏´‡∏ç‡∏¥‡∏á">‡∏´‡∏ç‡∏¥‡∏á</option>
                        <option value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
                    </select>
                    <select id="statusFilter" class="border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:border-primary">
                        <option value="">‡∏ó‡∏∏‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</option>
                        <option value="‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô">‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</option>
                        <option value="‡πÑ‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô">‡πÑ‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</option>
                        <option value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
                    </select>
                    <button id="refreshBtn" class="bg-primary text-white px-4 py-2 rounded-lg hover-primary transition-colors">
                        <span id="refreshText">‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</span>
                    </button>
                </div>
            </div>

            <!-- Workers Display -->
            <div id="workersContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Worker cards will be inserted here -->
            </div>
        </div>
    </div>

    <!-- Worker Form Modal -->
    <div id="workerFormModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-40 overflow-y-auto">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-screen overflow-y-auto">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-primary" id="formTitle">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</h2>
                        <button id="closeFormBtn" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
                    </div>
                    
                    <form id="workerForm" class="space-y-6">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <!-- Basic Information -->
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2" id="nameLabel">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• *</label>
                                <input type="text" id="fullName" required class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:border-primary">
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2" id="ageLabel">‡∏≠‡∏≤‡∏¢‡∏∏ *</label>
                                <input type="number" id="age" required min="15" max="80" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:border-primary">
                            </div>
                            
                            <div class="md:col-span-2">
                                <label class="block text-sm font-medium text-gray-700 mb-2" id="addressLabel">‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà *</label>
                                <textarea id="address" required rows="3" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:border-primary"></textarea>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2" id="phoneLabel">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå *</label>
                                <input type="tel" id="phone" required class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:border-primary">
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2" id="lineLabel">LINE ID</label>
                                <input type="text" id="lineId" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:border-primary">
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2" id="facebookLabel">‡∏ä‡∏∑‡πà‡∏≠ Facebook</label>
                                <input type="text" id="facebook" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:border-primary">
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2" id="genderLabel">‡πÄ‡∏û‡∏® *</label>
                                <select id="gender" required class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:border-primary">
                                    <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏û‡∏®</option>
                                    <option value="‡∏ä‡∏≤‡∏¢">‡∏ä‡∏≤‡∏¢</option>
                                    <option value="‡∏´‡∏ç‡∏¥‡∏á">‡∏´‡∏ç‡∏¥‡∏á</option>
                                    <option value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
                                </select>
                                <input type="text" id="genderOther" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏û‡∏®" class="w-full border border-gray-300 rounded-lg px-4 py-2 mt-2 hidden focus:outline-none focus:border-primary">
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2" id="experienceLabel">‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ó‡∏≥‡∏á‡∏≤‡∏ô *</label>
                                <textarea id="experience" required rows="3" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:border-primary"></textarea>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2" id="transportLabel">‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡πÑ‡∏î‡πâ‡πÄ‡∏≠‡∏á‡πÑ‡∏´‡∏° *</label>
                                <select id="transport" required class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:border-primary">
                                    <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</option>
                                    <option value="‡πÑ‡∏î‡πâ">‡πÑ‡∏î‡πâ</option>
                                    <option value="‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ">‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ</option>
                                </select>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2" id="statusLabel">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô *</label>
                                <select id="workStatus" required class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:border-primary">
                                    <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</option>
                                    <option value="‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô">‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</option>
                                    <option value="‡πÑ‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô">‡πÑ‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</option>
                                    <option value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
                                </select>
                                <input type="text" id="statusOther" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞" class="w-full border border-gray-300 rounded-lg px-4 py-2 mt-2 hidden focus:outline-none focus:border-primary">
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2" id="startDateLabel">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ</label>
                                <input type="date" id="startDate" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:border-primary">
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2" id="idTypeLabel">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô *</label>
                                <select id="idType" required class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:border-primary">
                                    <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</option>
                                    <option value="‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡πÑ‡∏ó‡∏¢">‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡πÑ‡∏ó‡∏¢</option>
                                    <option value="‡∏ö‡∏±‡∏ï‡∏£‡∏ï‡πà‡∏≤‡∏á‡∏î‡πâ‡∏≤‡∏ß">‡∏ö‡∏±‡∏ï‡∏£‡∏ï‡πà‡∏≤‡∏á‡∏î‡πâ‡∏≤‡∏ß</option>
                                    <option value="‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ö‡∏±‡∏ï‡∏£">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ö‡∏±‡∏ï‡∏£</option>
                                    <option value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
                                </select>
                                <input type="text" id="idTypeOther" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ö‡∏±‡∏ï‡∏£" class="w-full border border-gray-300 rounded-lg px-4 py-2 mt-2 hidden focus:outline-none focus:border-primary">
                            </div>
                            
                            <div class="md:col-span-2">
                                <label class="block text-sm font-medium text-gray-700 mb-2" id="healthLabel">‡πÇ‡∏£‡∏Ñ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß</label>
                                <textarea id="health" rows="2" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:border-primary" placeholder="‡πÑ‡∏°‡πà‡∏°‡∏µ ‡∏´‡∏£‡∏∑‡∏≠ ‡∏£‡∏∞‡∏ö‡∏∏‡πÇ‡∏£‡∏Ñ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß"></textarea>
                            </div>
                            
                            <!-- Multi-select fields -->
                            <div class="md:col-span-2">
                                <label class="block text-sm font-medium text-gray-700 mb-2" id="interestedJobLabel">‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏ô‡πÉ‡∏à * (‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏î‡πâ‡∏´‡∏•‡∏≤‡∏¢‡∏≠‡∏¢‡πà‡∏≤‡∏á)</label>
                                <div class="grid grid-cols-2 md:grid-cols-3 gap-2" id="interestedJobs">
                                    <label class="flex items-center"><input type="checkbox" value="‡∏Å‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á" class="mr-2"> ‡∏Å‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á</label>
                                    <label class="flex items-center"><input type="checkbox" value="‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î" class="mr-2"> ‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î</label>
                                    <label class="flex items-center"><input type="checkbox" value="‡∏Ç‡∏±‡∏ö‡∏£‡∏ñ" class="mr-2"> ‡∏Ç‡∏±‡∏ö‡∏£‡∏ñ</label>
                                    <label class="flex items-center"><input type="checkbox" value="‡∏ó‡∏≥‡∏≠‡∏≤‡∏´‡∏≤‡∏£" class="mr-2"> ‡∏ó‡∏≥‡∏≠‡∏≤‡∏´‡∏≤‡∏£</label>
                                    <label class="flex items-center"><input type="checkbox" value="‡∏î‡∏π‡πÅ‡∏•‡∏ú‡∏π‡πâ‡∏™‡∏π‡∏á‡∏≠‡∏≤‡∏¢‡∏∏" class="mr-2"> ‡∏î‡∏π‡πÅ‡∏•‡∏ú‡∏π‡πâ‡∏™‡∏π‡∏á‡∏≠‡∏≤‡∏¢‡∏∏</label>
                                    <label class="flex items-center"><input type="checkbox" value="‡∏î‡∏π‡πÅ‡∏•‡πÄ‡∏î‡πá‡∏Å" class="mr-2"> ‡∏î‡∏π‡πÅ‡∏•‡πÄ‡∏î‡πá‡∏Å</label>
                                    <label class="flex items-center"><input type="checkbox" value="‡∏á‡∏≤‡∏ô‡∏ö‡πâ‡∏≤‡∏ô" class="mr-2"> ‡∏á‡∏≤‡∏ô‡∏ö‡πâ‡∏≤‡∏ô</label>
                                    <label class="flex items-center"><input type="checkbox" value="‡∏á‡∏≤‡∏ô‡∏™‡∏ß‡∏ô" class="mr-2"> ‡∏á‡∏≤‡∏ô‡∏™‡∏ß‡∏ô</label>
                                    <label class="flex items-center"><input type="checkbox" value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ" class="mr-2" id="interestedOtherCheck"> ‡∏≠‡∏∑‡πà‡∏ô‡πÜ</label>
                                </div>
                                <input type="text" id="interestedOther" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏ô‡πÉ‡∏à‡∏≠‡∏∑‡πà‡∏ô‡πÜ" class="w-full border border-gray-300 rounded-lg px-4 py-2 mt-2 hidden focus:outline-none focus:border-primary">
                            </div>
                            
                            <div class="md:col-span-2">
                                <label class="block text-sm font-medium text-gray-700 mb-2" id="skillsLabel">‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÑ‡∏î‡πâ * (‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏î‡πâ‡∏´‡∏•‡∏≤‡∏¢‡∏≠‡∏¢‡πà‡∏≤‡∏á)</label>
                                <div class="grid grid-cols-2 md:grid-cols-3 gap-2" id="skills">
                                    <label class="flex items-center"><input type="checkbox" value="‡∏Å‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á" class="mr-2"> ‡∏Å‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á</label>
                                    <label class="flex items-center"><input type="checkbox" value="‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î" class="mr-2"> ‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î</label>
                                    <label class="flex items-center"><input type="checkbox" value="‡∏Ç‡∏±‡∏ö‡∏£‡∏ñ" class="mr-2"> ‡∏Ç‡∏±‡∏ö‡∏£‡∏ñ</label>
                                    <label class="flex items-center"><input type="checkbox" value="‡∏ó‡∏≥‡∏≠‡∏≤‡∏´‡∏≤‡∏£" class="mr-2"> ‡∏ó‡∏≥‡∏≠‡∏≤‡∏´‡∏≤‡∏£</label>
                                    <label class="flex items-center"><input type="checkbox" value="‡∏î‡∏π‡πÅ‡∏•‡∏ú‡∏π‡πâ‡∏™‡∏π‡∏á‡∏≠‡∏≤‡∏¢‡∏∏" class="mr-2"> ‡∏î‡∏π‡πÅ‡∏•‡∏ú‡∏π‡πâ‡∏™‡∏π‡∏á‡∏≠‡∏≤‡∏¢‡∏∏</label>
                                    <label class="flex items-center"><input type="checkbox" value="‡∏î‡∏π‡πÅ‡∏•‡πÄ‡∏î‡πá‡∏Å" class="mr-2"> ‡∏î‡∏π‡πÅ‡∏•‡πÄ‡∏î‡πá‡∏Å</label>
                                    <label class="flex items-center"><input type="checkbox" value="‡∏á‡∏≤‡∏ô‡∏ö‡πâ‡∏≤‡∏ô" class="mr-2"> ‡∏á‡∏≤‡∏ô‡∏ö‡πâ‡∏≤‡∏ô</label>
                                    <label class="flex items-center"><input type="checkbox" value="‡∏á‡∏≤‡∏ô‡∏™‡∏ß‡∏ô" class="mr-2"> ‡∏á‡∏≤‡∏ô‡∏™‡∏ß‡∏ô</label>
                                    <label class="flex items-center"><input type="checkbox" value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ" class="mr-2" id="skillsOtherCheck"> ‡∏≠‡∏∑‡πà‡∏ô‡πÜ</label>
                                </div>
                                <input type="text" id="skillsOther" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÑ‡∏î‡πâ‡∏≠‡∏∑‡πà‡∏ô‡πÜ" class="w-full border border-gray-300 rounded-lg px-4 py-2 mt-2 hidden focus:outline-none focus:border-primary">
                            </div>
                            
                            <div class="md:col-span-2">
                                <label class="block text-sm font-medium text-gray-700 mb-2" id="languagesLabel">‡∏†‡∏≤‡∏©‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£‡πÑ‡∏î‡πâ * (‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏î‡πâ‡∏´‡∏•‡∏≤‡∏¢‡∏†‡∏≤‡∏©‡∏≤)</label>
                                <div class="grid grid-cols-2 md:grid-cols-4 gap-2" id="languages">
                                    <label class="flex items-center"><input type="checkbox" value="‡πÑ‡∏ó‡∏¢" class="mr-2"> ‡πÑ‡∏ó‡∏¢</label>
                                    <label class="flex items-center"><input type="checkbox" value="‡∏à‡∏µ‡∏ô" class="mr-2"> ‡∏à‡∏µ‡∏ô</label>
                                    <label class="flex items-center"><input type="checkbox" value="‡πÑ‡∏ó‡∏¢‡πÉ‡∏´‡∏ç‡πà" class="mr-2"> ‡πÑ‡∏ó‡∏¢‡πÉ‡∏´‡∏ç‡πà</label>
                                    <label class="flex items-center"><input type="checkbox" value="‡∏û‡∏°‡πà‡∏≤" class="mr-2"> ‡∏û‡∏°‡πà‡∏≤</label>
                                    <label class="flex items-center"><input type="checkbox" value="‡∏≠‡∏≤‡∏Ç‡πà‡∏≤" class="mr-2"> ‡∏≠‡∏≤‡∏Ç‡πà‡∏≤</label>
                                    <label class="flex items-center"><input type="checkbox" value="‡∏•‡∏≤‡∏´‡∏π‡πà" class="mr-2"> ‡∏•‡∏≤‡∏´‡∏π‡πà</label>
                                    <label class="flex items-center"><input type="checkbox" value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ" class="mr-2" id="languageOtherCheck"> ‡∏≠‡∏∑‡πà‡∏ô‡πÜ</label>
                                </div>
                                <input type="text" id="languageOther" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏∑‡πà‡∏ô‡πÜ" class="w-full border border-gray-300 rounded-lg px-4 py-2 mt-2 hidden focus:outline-none focus:border-primary">
                            </div>
                            
                            <!-- Photo Upload -->
                            <div class="md:col-span-2">
                                <label class="block text-sm font-medium text-gray-700 mb-2" id="photoLabel">‡∏£‡∏π‡∏õ‡∏ñ‡πà‡∏≤‡∏¢‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏£‡∏á (.jpg/.png ‚â§2MB)</label>
                                <input type="file" id="photo" accept=".jpg,.jpeg,.png" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:border-primary">
                                <div id="photoPreview" class="mt-4 hidden">
                                    <img id="previewImg" class="w-32 h-32 object-cover rounded-lg border">
                                </div>
                            </div>
                        </div>
                        
                        <div class="flex justify-end space-x-4 pt-6 border-t">
                            <button type="button" id="cancelBtn" class="px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors">
                                <span id="cancelText">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</span>
                            </button>
                            <button type="submit" id="submitBtn" class="px-6 py-2 bg-primary text-white rounded-lg hover-primary transition-colors">
                                <span id="submitText">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</span>
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Worker Detail Modal -->
    <div id="workerDetailModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-40 overflow-y-auto">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-screen overflow-y-auto">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-primary" id="detailTitle">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</h2>
                        <button id="closeDetailBtn" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
                    </div>
                    <div id="workerDetailContent">
                        <!-- Worker details will be inserted here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Form Management Modal -->
    <div id="formManagementModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 overflow-y-auto">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-2xl shadow-2xl max-w-6xl w-full max-h-screen overflow-y-auto">
                <div class="p-8">
                    <div class="flex justify-between items-center mb-8">
                        <div>
                            <h2 class="text-3xl font-bold text-primary mb-2" id="formManagementTitle">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°</h2>
                            <p class="text-gray-600">‡πÄ‡∏û‡∏¥‡πà‡∏° ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç ‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÉ‡∏ô‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°</p>
                        </div>
                        <button id="closeFormManagementBtn" class="text-gray-400 hover:text-gray-600 text-3xl transition-colors">&times;</button>
                    </div>
                    
                    <div class="mb-8">
                        <div class="flex flex-wrap gap-4 mb-6">
                            <button id="addFieldBtn" class="bg-gradient-to-r from-green-500 to-green-600 text-white px-6 py-3 rounded-xl hover:from-green-600 hover:to-green-700 transition-all duration-300 shadow-lg flex items-center space-x-2">
                                <span class="text-xl">‚ûï</span>
                                <span>‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÉ‡∏´‡∏°‡πà</span>
                            </button>
                            <button id="previewFormBtn" class="bg-gradient-to-r from-blue-500 to-blue-600 text-white px-6 py-3 rounded-xl hover:from-blue-600 hover:to-blue-700 transition-all duration-300 shadow-lg flex items-center space-x-2">
                                <span class="text-xl">üëÅÔ∏è</span>
                                <span>‡∏î‡∏π‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°</span>
                            </button>
                            <button id="importQuestionsBtn" class="bg-gradient-to-r from-purple-500 to-purple-600 text-white px-6 py-3 rounded-xl hover:from-purple-600 hover:to-purple-700 transition-all duration-300 shadow-lg flex items-center space-x-2">
                                <span class="text-xl">üì•</span>
                                <span>‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°</span>
                            </button>
                            <button id="exportQuestionsBtn" class="bg-gradient-to-r from-orange-500 to-orange-600 text-white px-6 py-3 rounded-xl hover:from-orange-600 hover:to-orange-700 transition-all duration-300 shadow-lg flex items-center space-x-2">
                                <span class="text-xl">üì§</span>
                                <span>‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°</span>
                            </button>
                        </div>
                        
                        <!-- Language Toggle for Form Management -->
                        <div class="mb-6 bg-gray-50 p-4 rounded-xl">
                            <label class="block text-sm font-medium text-gray-700 mb-2">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÉ‡∏ô‡∏†‡∏≤‡∏©‡∏≤:</label>
                            <div class="flex space-x-4">
                                <button id="editFormThai" class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors">
                                    üáπüá≠ ‡πÑ‡∏ó‡∏¢
                                </button>
                                <button id="editFormChinese" class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors">
                                    üá®üá≥ ‰∏≠Êñá
                                </button>
                            </div>
                        </div>
                        
                        <div id="formFieldsList" class="space-y-6">
                            <!-- Form fields management will be inserted here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Question Editor Modal -->
    <div id="questionEditorModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 overflow-y-auto">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-2xl shadow-2xl max-w-4xl w-full max-h-screen overflow-y-auto">
                <div class="p-8">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-primary" id="questionEditorTitle">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°</h2>
                        <button id="closeQuestionEditorBtn" class="text-gray-400 hover:text-gray-600 text-3xl">&times;</button>
                    </div>
                    
                    <form id="questionEditorForm" class="space-y-6">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° (‡πÑ‡∏ó‡∏¢) *</label>
                                <input type="text" id="questionThai" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:border-primary" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° (‡∏à‡∏µ‡∏ô) *</label>
                                <input type="text" id="questionChinese" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:border-primary" required>
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°</label>
                            <select id="questionType" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:border-primary">
                                <option value="text">‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡πâ‡∏ô</option>
                                <option value="textarea">‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß</option>
                                <option value="number">‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç</option>
                                <option value="date">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</option>
                                <option value="select">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏î‡∏µ‡∏¢‡∏ß</option>
                                <option value="checkbox">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏•‡∏≤‡∏¢‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</option>
                                <option value="radio">‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</option>
                                <option value="file">‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå</option>
                            </select>
                        </div>
                        
                        <div class="flex items-center space-x-4">
                            <label class="flex items-center">
                                <input type="checkbox" id="questionRequired" class="mr-2">
                                <span class="text-sm">‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" id="questionMultiLanguage" class="mr-2">
                                <span class="text-sm">‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏´‡∏•‡∏≤‡∏¢‡∏†‡∏≤‡∏©‡∏≤</span>
                            </label>
                        </div>
                        
                        <!-- Options for select/checkbox/radio types -->
                        <div id="questionOptions" class="hidden">
                            <label class="block text-sm font-medium text-gray-700 mb-2">‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö</label>
                            <div id="optionsList" class="space-y-3">
                                <!-- Options will be inserted here -->
                            </div>
                            <button type="button" id="addOptionBtn" class="mt-3 bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600 transition-colors">
                                ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
                            </button>
                        </div>
                        
                        <div class="flex justify-end space-x-4 pt-6 border-t">
                            <button type="button" id="cancelQuestionBtn" class="px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors">
                                ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                            </button>
                            <button type="submit" class="px-6 py-2 bg-primary text-white rounded-lg hover-primary transition-colors">
                                ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Content Editor Modal -->
    <div id="contentEditorModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 overflow-y-auto">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-screen overflow-y-auto">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-primary" id="contentEditorTitle">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏£‡∏∞‡∏ö‡∏ö</h2>
                        <button id="closeContentEditorBtn" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
                    </div>
                    
                    <div class="mb-6">
                        <div class="flex space-x-4 mb-4">
                            <button id="editThaiBtn" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                                ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢
                            </button>
                            <button id="editChineseBtn" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors">
                                ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏†‡∏≤‡∏©‡∏≤‡∏à‡∏µ‡∏ô
                            </button>
                        </div>
                        
                        <div id="contentEditor" class="space-y-4">
                            <!-- Content editor will be inserted here -->
                        </div>
                        
                        <div class="flex justify-end space-x-4 mt-6">
                            <button id="saveContentBtn" class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition-colors">
                                ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Admin Panel -->
    <div id="adminPanel" class="fixed inset-0 bg-black bg-opacity-50 hidden z-40 overflow-y-auto">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-screen overflow-y-auto">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-primary" id="adminTitle">‡∏£‡∏∞‡∏ö‡∏ö‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•</h2>
                        <button id="closeAdminBtn" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
                    </div>
                    
                    <!-- Admin Login -->
                    <div id="adminLogin">
                        <div class="max-w-md mx-auto">
                            <label class="block text-sm font-medium text-gray-700 mb-2" id="passwordLabel">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•</label>
                            <input type="password" id="adminPassword" class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:border-primary mb-4">
                            <button id="adminLoginBtn" class="w-full bg-primary text-white py-2 rounded-lg hover-primary transition-colors">
                                <span id="loginText">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</span>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Admin Dashboard -->
                    <div id="adminDashboard" class="hidden">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                            <div class="bg-blue-100 p-6 rounded-lg text-center">
                                <h3 class="text-2xl font-bold text-blue-600" id="totalWorkers">0</h3>
                                <p class="text-blue-800" id="totalWorkersLabel">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
                            </div>
                            <div class="bg-green-100 p-6 rounded-lg text-center">
                                <h3 class="text-2xl font-bold text-green-600" id="availableWorkers">0</h3>
                                <p class="text-green-800" id="availableWorkersLabel">‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</p>
                            </div>
                            <div class="bg-yellow-100 p-6 rounded-lg text-center">
                                <h3 class="text-2xl font-bold text-yellow-600" id="recentWorkers">0</h3>
                                <p class="text-yellow-800" id="recentWorkersLabel">‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏ô 7 ‡∏ß‡∏±‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</p>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 mb-8">
                            <button id="exportBtn" class="p-6 bg-green-500 text-white rounded-xl hover:bg-green-600 transition-colors">
                                <i class="fas fa-file-excel text-2xl mb-2"></i>
                                <p class="font-semibold">Export Excel</p>
                            </button>
                            <button id="resetSheetBtn" class="p-6 bg-red-500 text-white rounded-xl hover:bg-red-600 transition-colors">
                                <i class="fas fa-trash-alt text-2xl mb-2"></i>
                                <p class="font-semibold">Reset Sheet</p>
                            </button>
                            <button id="manageFormBtn" class="p-6 bg-purple-500 text-white rounded-xl hover:bg-purple-600 transition-colors">
                                <i class="fas fa-cogs text-2xl mb-2"></i>
                                <p class="font-semibold">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°</p>
                            </button>
                            <button id="editContentBtn" class="p-6 bg-indigo-500 text-white rounded-xl hover:bg-indigo-600 transition-colors">
                                <i class="fas fa-edit text-2xl mb-2"></i>
                                <p class="font-semibold">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤</p>
                            </button>
                            <button id="testUploadBtn" class="p-6 bg-orange-500 text-white rounded-xl hover:bg-orange-600 transition-colors">
                                <i class="fas fa-camera text-2xl mb-2"></i>
                                <p class="font-semibold">‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î</p>
                            </button>
                        </div>
                        
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                            <div class="bg-white rounded-xl p-6 shadow-lg">
                                <h3 class="text-xl font-semibold text-gray-800 mb-4 flex items-center">
                                    <i class="fas fa-plug text-purple-600 mr-2"></i>
                                    ‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠
                                </h3>
                                <button onclick="testConnection()" class="w-full p-4 bg-purple-500 text-white rounded-xl hover:bg-purple-600 transition-colors mb-4">
                                    <i class="fas fa-sync-alt text-xl mb-2"></i>
                                    <p class="font-semibold">‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠</p>
                                </button>
                                <div class="space-y-3 text-sm">
                                    <div class="flex justify-between items-center">
                                        <span class="flex items-center">
                                            <i class="fas fa-table text-green-600 mr-2"></i>
                                            Google Sheets
                                        </span>
                                        <span id="adminSheetStatus" class="text-gray-600">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö...</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="flex items-center">
                                            <i class="fas fa-cloud text-blue-600 mr-2"></i>
                                            Cloudinary
                                        </span>
                                        <span id="adminDriveStatus" class="text-gray-600">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö...</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-white rounded-xl p-6 shadow-lg">
                                <h3 class="text-xl font-semibold text-gray-800 mb-4 flex items-center">
                                    <i class="fas fa-info-circle text-blue-600 mr-2"></i>
                                    ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏∞‡∏ö‡∏ö
                                </h3>
                                <div class="space-y-3 text-sm">
                                    <div>
                                        <strong class="text-gray-700">Google Sheet URL:</strong><br>
                                        <code class="bg-gray-100 px-2 py-1 rounded text-xs break-all">https://script.google.com/macros/s/AKfycbzVEalHIMOwzdNtgwXrgLr8qkJNWadLukyoXzTDzvsYYqx3wtzjbIPpndpzdcLNOZjA/exec</code>
                                    </div>
                                    <div>
                                        <strong class="text-gray-700">Cloudinary Settings:</strong><br>
                                        <div class="text-xs text-gray-600 mt-1">
                                            <p>Cloud Name: dicxzovzt</p>
                                            <p>Upload Preset: unsigned_preset</p>
                                            <p>Folder: worker_photos</p>
                                        </div>
                                    </div>
                                    <div>
                                        <strong class="text-gray-700">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠:</strong><br>
                                        <span id="adminConnectionStatus" class="text-gray-600">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö...</span>
                                    </div>
                                    <div>
                                        <strong class="text-gray-700">‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡∏£‡∏∞‡∏ö‡∏ö:</strong><br>
                                        <span class="text-gray-600">v2.1.0</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div id="adminWorkersList" class="space-y-4">
                            <!-- Admin workers list will be inserted here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

<script>
function setTextSafely(id, text){
  const el = document.getElementById(id);
  if(!el){ console.warn(`‚ö†Ô∏è #${id} not found, skip setText`); return; }
  el.textContent = text;
}
document.addEventListener('DOMContentLoaded', () => {
  // ‡∏ñ‡πâ‡∏≤‡∏õ‡∏∏‡πà‡∏° ‚Äú‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‚Äù ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å checkConnections ‡πÄ‡∏≠‡∏á‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ã‡πâ‡∏≥
  // ‡πÅ‡∏ï‡πà‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏´‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î ‡∏Å‡πá‡∏õ‡∏•‡∏î‡∏Ñ‡∏≠‡∏°‡πÄ‡∏°‡∏ô‡∏ï‡πå‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏•‡πà‡∏≤‡∏á‡∏ô‡∏µ‡πâ
  // checkConnections();
});
</script>

    <script>
        // Global variables
        let currentLanguage = 'th';
        let workersData = [];
        let workerCounter = 1;
        const ADMIN_PASSWORD = 'admin123';
        const SHEET_URL = 'https://script.google.com/macros/s/AKfycbzMUqIYGq3sXC-4-DJu-QfKuwSWUfKJkzmmxnNH6rydXIAW3EJAfKLDh8hc1XcMWYA/exec';
        
        // Test photo upload function for debugging
        async function testPhotoUpload() {
            console.log('üß™ Starting Cloudinary photo upload test...');
            
            // Create a small test image (1x1 pixel PNG)
            const canvas = document.createElement('canvas');
            canvas.width = 1;
            canvas.height = 1;
            const ctx = canvas.getContext('2d');
            ctx.fillStyle = '#FF0000';
            ctx.fillRect(0, 0, 1, 1);
            
            return new Promise((resolve) => {
                canvas.toBlob(async (blob) => {
                    try {
                        const testFile = new File([blob], 'test.png', { type: 'image/png' });
                        console.log('üß™ Test file created:', testFile.name, testFile.size, 'bytes');
                        
                        const result = await uploadPhotoToCloudinary(testFile, 'TEST001');
                        console.log('üß™ Test upload result:', result);
                        resolve(result);
                    } catch (error) {
                        console.error('üß™ Test upload failed:', error);
                        resolve(null);
                    }
                }, 'image/png');
            });
        }
        
        // Form configuration
        let formFields = [
            { id: 'fullName', type: 'text', required: true, label: { th: '‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•', zh: 'ÂßìÂêç' } },
            { id: 'age', type: 'number', required: true, label: { th: '‡∏≠‡∏≤‡∏¢‡∏∏', zh: 'Âπ¥ÈΩ°' }, min: 15, max: 80 },
            { id: 'address', type: 'textarea', required: true, label: { th: '‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà', zh: 'Âú∞ÂùÄ' } },
            { id: 'phone', type: 'tel', required: true, label: { th: '‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå', zh: 'ÈõªË©±ËôüÁ¢º' } },
            { id: 'lineId', type: 'text', required: false, label: { th: 'LINE ID', zh: 'LINE ID' } },
            { id: 'facebook', type: 'text', required: false, label: { th: '‡∏ä‡∏∑‡πà‡∏≠ Facebook', zh: 'Facebook ÂßìÂêç' } },
            { id: 'gender', type: 'select', required: true, label: { th: '‡πÄ‡∏û‡∏®', zh: 'ÊÄßÂà•' }, options: [
                { value: '‡∏ä‡∏≤‡∏¢', label: { th: '‡∏ä‡∏≤‡∏¢', zh: 'Áî∑' } },
                { value: '‡∏´‡∏ç‡∏¥‡∏á', label: { th: '‡∏´‡∏ç‡∏¥‡∏á', zh: 'Â•≥' } },
                { value: '‡∏≠‡∏∑‡πà‡∏ô‡πÜ', label: { th: '‡∏≠‡∏∑‡πà‡∏ô‡πÜ', zh: 'ÂÖ∂‰ªñ' } }
            ]},
            { id: 'experience', type: 'textarea', required: true, label: { th: '‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ó‡∏≥‡∏á‡∏≤‡∏ô', zh: 'Â∑•‰ΩúÁ∂ìÈ©ó' } },
            { id: 'transport', type: 'select', required: true, label: { th: '‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡πÑ‡∏î‡πâ‡πÄ‡∏≠‡∏á‡πÑ‡∏´‡∏°', zh: 'ËÉΩËá™Ë°åÈÄöÂã§Âóé' }, options: [
                { value: '‡πÑ‡∏î‡πâ', label: { th: '‡πÑ‡∏î‡πâ', zh: 'ÂèØ‰ª•' } },
                { value: '‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ', label: { th: '‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ', zh: '‰∏çÂèØ‰ª•' } }
            ]},
            { id: 'workStatus', type: 'select', required: true, label: { th: '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô', zh: 'Â∑•‰ΩúÁãÄÊÖã' }, options: [
                { value: '‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô', label: { th: '‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô', zh: 'ÂèØÂ∑•‰Ωú' } },
                { value: '‡πÑ‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô', label: { th: '‡πÑ‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô', zh: '‰∏çÂèØÂ∑•‰Ωú' } },
                { value: '‡∏≠‡∏∑‡πà‡∏ô‡πÜ', label: { th: '‡∏≠‡∏∑‡πà‡∏ô‡πÜ', zh: 'ÂÖ∂‰ªñ' } }
            ]},
            { id: 'startDate', type: 'date', required: false, label: { th: '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ', zh: 'ÂèØÈñãÂßãÂ∑•‰ΩúÊó•Êúü' } },
            { id: 'idType', type: 'select', required: true, label: { th: '‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô', zh: 'Ë∫´‰ªΩË≠âÈ°ûÂûã' }, options: [
                { value: '‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡πÑ‡∏ó‡∏¢', label: { th: '‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡πÑ‡∏ó‡∏¢', zh: 'Ê≥∞ÂúãË∫´‰ªΩË≠â' } },
                { value: '‡∏ö‡∏±‡∏ï‡∏£‡∏ï‡πà‡∏≤‡∏á‡∏î‡πâ‡∏≤‡∏ß', label: { th: '‡∏ö‡∏±‡∏ï‡∏£‡∏ï‡πà‡∏≤‡∏á‡∏î‡πâ‡∏≤‡∏ß', zh: 'Â§ñÂúã‰∫∫Ë∫´‰ªΩË≠â' } },
                { value: '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ö‡∏±‡∏ï‡∏£', label: { th: '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ö‡∏±‡∏ï‡∏£', zh: 'ÁÑ°Ë∫´‰ªΩË≠â' } },
                { value: '‡∏≠‡∏∑‡πà‡∏ô‡πÜ', label: { th: '‡∏≠‡∏∑‡πà‡∏ô‡πÜ', zh: 'ÂÖ∂‰ªñ' } }
            ]},
            { id: 'health', type: 'textarea', required: false, label: { th: '‡πÇ‡∏£‡∏Ñ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß', zh: 'ÊÖ¢ÊÄßÁñæÁóÖ' } },
            { id: 'interestedJobs', type: 'checkbox', required: true, label: { th: '‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏ô‡πÉ‡∏à', zh: 'ÊÑüËààË∂£ÁöÑÂ∑•‰Ωú' }, options: [
                { value: '‡∏Å‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á', label: { th: '‡∏Å‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á', zh: 'Âª∫ÁØâ' } },
                { value: '‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î', label: { th: '‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î', zh: 'Ê∏ÖÊΩî' } },
                { value: '‡∏Ç‡∏±‡∏ö‡∏£‡∏ñ', label: { th: '‡∏Ç‡∏±‡∏ö‡∏£‡∏ñ', zh: 'ÈßïÈßõ' } },
                { value: '‡∏ó‡∏≥‡∏≠‡∏≤‡∏´‡∏≤‡∏£', label: { th: '‡∏ó‡∏≥‡∏≠‡∏≤‡∏´‡∏≤‡∏£', zh: 'ÁÉπÈ£™' } },
                { value: '‡∏î‡∏π‡πÅ‡∏•‡∏ú‡∏π‡πâ‡∏™‡∏π‡∏á‡∏≠‡∏≤‡∏¢‡∏∏', label: { th: '‡∏î‡∏π‡πÅ‡∏•‡∏ú‡∏π‡πâ‡∏™‡∏π‡∏á‡∏≠‡∏≤‡∏¢‡∏∏', zh: 'ÁÖßÈ°ßËÄÅ‰∫∫' } },
                { value: '‡∏î‡∏π‡πÅ‡∏•‡πÄ‡∏î‡πá‡∏Å', label: { th: '‡∏î‡∏π‡πÅ‡∏•‡πÄ‡∏î‡πá‡∏Å', zh: 'ÁÖßÈ°ßÂÖíÁ´•' } },
                { value: '‡∏á‡∏≤‡∏ô‡∏ö‡πâ‡∏≤‡∏ô', label: { th: '‡∏á‡∏≤‡∏ô‡∏ö‡πâ‡∏≤‡∏ô', zh: 'ÂÆ∂Âãô' } },
                { value: '‡∏á‡∏≤‡∏ô‡∏™‡∏ß‡∏ô', label: { th: '‡∏á‡∏≤‡∏ô‡∏™‡∏ß‡∏ô', zh: 'ÂúíËóù' } },
                { value: '‡∏≠‡∏∑‡πà‡∏ô‡πÜ', label: { th: '‡∏≠‡∏∑‡πà‡∏ô‡πÜ', zh: 'ÂÖ∂‰ªñ' } }
            ]},
            { id: 'skills', type: 'checkbox', required: true, label: { th: '‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÑ‡∏î‡πâ', zh: 'ËÉΩÂÅöÁöÑÂ∑•‰Ωú' }, options: [
                { value: '‡∏Å‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á', label: { th: '‡∏Å‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á', zh: 'Âª∫ÁØâ' } },
                { value: '‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î', label: { th: '‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î', zh: 'Ê∏ÖÊΩî' } },
                { value: '‡∏Ç‡∏±‡∏ö‡∏£‡∏ñ', label: { th: '‡∏Ç‡∏±‡∏ö‡∏£‡∏ñ', zh: 'ÈßïÈßõ' } },
                { value: '‡∏ó‡∏≥‡∏≠‡∏≤‡∏´‡∏≤‡∏£', label: { th: '‡∏ó‡∏≥‡∏≠‡∏≤‡∏´‡∏≤‡∏£', zh: 'ÁÉπÈ£™' } },
                { value: '‡∏î‡∏π‡πÅ‡∏•‡∏ú‡∏π‡πâ‡∏™‡∏π‡∏á‡∏≠‡∏≤‡∏¢‡∏∏', label: { th: '‡∏î‡∏π‡πÅ‡∏•‡∏ú‡∏π‡πâ‡∏™‡∏π‡∏á‡∏≠‡∏≤‡∏¢‡∏∏', zh: 'ÁÖßÈ°ßËÄÅ‰∫∫' } },
                { value: '‡∏î‡∏π‡πÅ‡∏•‡πÄ‡∏î‡πá‡∏Å', label: { th: '‡∏î‡∏π‡πÅ‡∏•‡πÄ‡∏î‡πá‡∏Å', zh: 'ÁÖßÈ°ßÂÖíÁ´•' } },
                { value: '‡∏á‡∏≤‡∏ô‡∏ö‡πâ‡∏≤‡∏ô', label: { th: '‡∏á‡∏≤‡∏ô‡∏ö‡πâ‡∏≤‡∏ô', zh: 'ÂÆ∂Âãô' } },
                { value: '‡∏á‡∏≤‡∏ô‡∏™‡∏ß‡∏ô', label: { th: '‡∏á‡∏≤‡∏ô‡∏™‡∏ß‡∏ô', zh: 'ÂúíËóù' } },
                { value: '‡∏≠‡∏∑‡πà‡∏ô‡πÜ', label: { th: '‡∏≠‡∏∑‡πà‡∏ô‡πÜ', zh: 'ÂÖ∂‰ªñ' } }
            ]},
            { id: 'languages', type: 'checkbox', required: true, label: { th: '‡∏†‡∏≤‡∏©‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£‡πÑ‡∏î‡πâ', zh: 'ËÉΩÊ∫ùÈÄöÁöÑË™ûË®Ä' }, options: [
                { value: '‡πÑ‡∏ó‡∏¢', label: { th: '‡πÑ‡∏ó‡∏¢', zh: 'Ê≥∞Ë™û' } },
                { value: '‡∏à‡∏µ‡∏ô', label: { th: '‡∏à‡∏µ‡∏ô', zh: '‰∏≠Êñá' } },
                { value: '‡πÑ‡∏ó‡∏¢‡πÉ‡∏´‡∏ç‡πà', label: { th: '‡πÑ‡∏ó‡∏¢‡πÉ‡∏´‡∏ç‡πà', zh: 'ÂÇ£Ë™û' } },
                { value: '‡∏û‡∏°‡πà‡∏≤', label: { th: '‡∏û‡∏°‡πà‡∏≤', zh: 'Á∑¨Áî∏Ë™û' } },
                { value: '‡∏≠‡∏≤‡∏Ç‡πà‡∏≤', label: { th: '‡∏≠‡∏≤‡∏Ç‡πà‡∏≤', zh: 'ÈòøÂç°Ë™û' } },
                { value: '‡∏•‡∏≤‡∏´‡∏π‡πà', label: { th: '‡∏•‡∏≤‡∏´‡∏π‡πà', zh: 'ÊãâËÉ°Ë™û' } },
                { value: '‡∏≠‡∏∑‡πà‡∏ô‡πÜ', label: { th: '‡∏≠‡∏∑‡πà‡∏ô‡πÜ', zh: 'ÂÖ∂‰ªñ' } }
            ]},
            { id: 'photo', type: 'file', required: false, label: { th: '‡∏£‡∏π‡∏õ‡∏ñ‡πà‡∏≤‡∏¢‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏£‡∏á', zh: 'Ê≠£Èù¢ÁÖßÁâá' }, accept: '.jpg,.jpeg,.png' }
        ];

        // Language translations
        const translations = {
            th: {
                titleChinese: 'Âú®Âú∞Âπ´Âπ´Â∑•',
                titleThai: '‡∏ä‡πà‡∏ß‡∏¢‡∏´‡∏≤‡∏á‡∏≤‡∏ô‡∏ä‡πà‡∏ß‡∏¢‡∏´‡∏≤‡∏Ñ‡∏ô',
                subtitle: 'Local Worker Connect Platform',
                startBtnText: '‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô',
                aboutBtnText: '‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÄ‡∏£‡∏≤',
                navTitle: '‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å',
                addWorkerText: '‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å',
                adminText: '‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö',
                searchTitle: '‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÅ‡∏•‡∏∞‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•',
                refreshText: '‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•',
                formTitle: '‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å',
                nameLabel: '‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• *',
                ageLabel: '‡∏≠‡∏≤‡∏¢‡∏∏ *',
                addressLabel: '‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà *',
                phoneLabel: '‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå *',
                lineLabel: 'LINE ID',
                facebookLabel: '‡∏ä‡∏∑‡πà‡∏≠ Facebook',
                genderLabel: '‡πÄ‡∏û‡∏® *',
                experienceLabel: '‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ó‡∏≥‡∏á‡∏≤‡∏ô *',
                transportLabel: '‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡πÑ‡∏î‡πâ‡πÄ‡∏≠‡∏á‡πÑ‡∏´‡∏° *',
                statusLabel: '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô *',
                startDateLabel: '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ',
                idTypeLabel: '‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô *',
                healthLabel: '‡πÇ‡∏£‡∏Ñ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß',
                interestedJobLabel: '‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏ô‡πÉ‡∏à * (‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏î‡πâ‡∏´‡∏•‡∏≤‡∏¢‡∏≠‡∏¢‡πà‡∏≤‡∏á)',
                skillsLabel: '‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÑ‡∏î‡πâ * (‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏î‡πâ‡∏´‡∏•‡∏≤‡∏¢‡∏≠‡∏¢‡πà‡∏≤‡∏á)',
                languagesLabel: '‡∏†‡∏≤‡∏©‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£‡πÑ‡∏î‡πâ * (‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏î‡πâ‡∏´‡∏•‡∏≤‡∏¢‡∏†‡∏≤‡∏©‡∏≤)',
                photoLabel: 'Ê≠£Èù¢ÁÖßÁâá (.jpg/.png ‚â§1MB)',
                cancelText: '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å',
                submitText: '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•',
                detailTitle: '‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å',
                adminTitle: '‡∏£‡∏∞‡∏ö‡∏ö‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•',
                passwordLabel: '‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•',
                loginText: '‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö',
                totalWorkersLabel: '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î',
                availableWorkersLabel: '‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô',
                recentWorkersLabel: '‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏ô 7 ‡∏ß‡∏±‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î',
                exportText: 'Export Excel',
                resetText: 'Reset Sheet',
                manageFormText: '‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°',
                editContentText: '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤',
                formManagementTitle: '‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°',
                contentEditorTitle: '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏£‡∏∞‡∏ö‡∏ö'
            },
            zh: {
                titleChinese: 'Âú®Âú∞Âπ´Âπ´Â∑•',
                titleThai: 'Âπ´Âä©ÊâæÂ∑•‰ΩúÂπ´Âä©Êâæ‰∫∫',
                subtitle: 'Êú¨Âú∞Âπ´Â∑•ÈÄ£Êé•Âπ≥Âè∞',
                startBtnText: 'ÈñãÂßã‰ΩøÁî®',
                aboutBtnText: 'ÈóúÊñºÊàëÂÄë',
                navTitle: 'Âπ´Â∑•ÁÆ°ÁêÜÁ≥ªÁµ±',
                addWorkerText: 'Êñ∞Â¢ûÂπ´Â∑•',
                adminText: 'Á≥ªÁµ±ÁÆ°ÁêÜÂì°',
                searchTitle: 'ÊêúÁ¥¢ÂíåÁØ©ÈÅ∏Êï∏Êìö',
                refreshText: 'Âà∑Êñ∞Êï∏Êìö',
                formTitle: 'Êñ∞Â¢ûÂπ´Â∑•Ë≥áÊñô',
                nameLabel: 'ÂßìÂêç *',
                ageLabel: 'Âπ¥ÈΩ° *',
                addressLabel: 'Âú∞ÂùÄ *',
                phoneLabel: 'ÈõªË©±ËôüÁ¢º *',
                lineLabel: 'LINE ID',
                facebookLabel: 'Facebook ÂßìÂêç',
                genderLabel: 'ÊÄßÂà• *',
                experienceLabel: 'Â∑•‰ΩúÁ∂ìÈ©ó *',
                transportLabel: 'ËÉΩËá™Ë°åÈÄöÂã§Âóé *',
                statusLabel: 'Â∑•‰ΩúÁãÄÊÖã *',
                startDateLabel: 'ÂèØÈñãÂßãÂ∑•‰ΩúÊó•Êúü',
                idTypeLabel: 'Ë∫´‰ªΩË≠âÈ°ûÂûã *',
                healthLabel: 'ÊÖ¢ÊÄßÁñæÁóÖ',
                interestedJobLabel: 'ÊÑüËààË∂£ÁöÑÂ∑•‰Ωú * (ÂèØÂ§öÈÅ∏)',
                skillsLabel: 'ËÉΩÂÅöÁöÑÂ∑•‰Ωú * (ÂèØÂ§öÈÅ∏)',
                languagesLabel: 'ËÉΩÊ∫ùÈÄöÁöÑË™ûË®Ä * (ÂèØÂ§öÈÅ∏)',
                photoLabel: 'Ê≠£Èù¢ÁÖßÁâá (.jpg/.png ‚â§2MB)',
                cancelText: 'ÂèñÊ∂à',
                submitText: '‰øùÂ≠òÊï∏Êìö',
                detailTitle: 'Âπ´Â∑•Ë©≥ÊÉÖ',
                adminTitle: 'ÁÆ°ÁêÜÂì°Á≥ªÁµ±',
                passwordLabel: 'ÁÆ°ÁêÜÂì°ÂØÜÁ¢º',
                loginText: 'ÁôªÂÖ•Á≥ªÁµ±',
                totalWorkersLabel: 'Á∏ΩÂπ´Â∑•Êï∏Èáè',
                availableWorkersLabel: 'ÂèØÂ∑•‰Ωú',
                recentWorkersLabel: 'ÊúÄËøë7Â§©Êñ∞Â¢û',
                exportText: 'Â∞éÂá∫Excel',
                resetText: 'ÈáçÁΩÆË°®Ê†º',
                manageFormText: 'ÁÆ°ÁêÜË°®ÂñÆ',
                editContentText: 'Á∑®ËºØÂÖßÂÆπ',
                formManagementTitle: 'ÁÆ°ÁêÜË°®ÂñÆ',
                contentEditorTitle: 'Á∑®ËºØÁ≥ªÁµ±ÂÖßÂÆπ'
            }
        };

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
            setupEventListeners();
            updateLanguage();
            startConnectionMonitoring();
        });

        function initializeApp() {
            // Set minimum date to today
            const today = new Date().toISOString().split('T')[0];
            if (document.getElementById('startDate')) {
                document.getElementById('startDate').min = today;
            }
            
            // Load workers data
            loadWorkersData();
        }

        // Connection Monitoring Functions
        function startConnectionMonitoring() {
            // Check connections every 30 seconds
            checkConnections();
            setInterval(checkConnections, 30000);
        }

        async function checkConnections() {
            await Promise.all([
                checkSheetConnection(),
                checkDriveConnection()
            ]);
            
            // Update admin panel if it's open
            if (!document.getElementById('adminDashboard').classList.contains('hidden')) {
                updateAdminConnectionStatus();
            }
            
            // Update last update time
            const now = new Date();
            document.getElementById('lastUpdate').textContent = now.toLocaleTimeString('th-TH');
        }

        async function checkSheetConnection() {
            // Only update admin panel status if it exists
            const adminSheetStatus = document.getElementById('adminSheetStatus');
            if (!adminSheetStatus) return;
            
            try {
                // Set checking status
                adminSheetStatus.textContent = '‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö...';
                adminSheetStatus.className = 'text-yellow-600';
                
                // Test connection to Google Sheets
                const response = await fetch(SHEET_URL + '?test=1', {
                    method: 'GET',
                    mode: 'no-cors'
                });
                
                // If we get here without error, connection is likely working
                adminSheetStatus.textContent = '‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÅ‡∏•‡πâ‡∏ß';
                adminSheetStatus.className = 'text-green-600';
                
            } catch (error) {
                adminSheetStatus.textContent = '‡πÑ‡∏°‡πà‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠';
                adminSheetStatus.className = 'text-red-600';
            }
        }

        async function checkDriveConnection() {
            // Only update admin panel status if it exists
            const adminDriveStatus = document.getElementById('adminDriveStatus');
            if (!adminDriveStatus) return;
            
            try {
                // Set checking status
                adminDriveStatus.textContent = '‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö...';
                adminDriveStatus.className = 'text-yellow-600';
                
                // Test actual Cloudinary connection
                console.log('üîÑ Starting Cloudinary connection test...');
                const response = await testCloudinaryConnection();
                
                if (response && response.status === 'success') {
                    console.log('‚úÖ Drive connection successful:', response);
                    adminDriveStatus.textContent = '‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÅ‡∏•‡πâ‡∏ß';
                    adminDriveStatus.className = 'text-green-600';
                } else {
                    console.log('‚ùå Drive connection failed:', response);
                    adminDriveStatus.textContent = '‡πÑ‡∏°‡πà‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠';
                    adminDriveStatus.className = 'text-red-600';
                }
                
            } catch (error) {
                console.error('Drive connection test failed:', error);
                adminDriveStatus.textContent = '‡πÑ‡∏°‡πà‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠';
                adminDriveStatus.className = 'text-red-600';
            }
        }

        function testConnection() {
            // Show loading dialog
            Swal.fire({
                title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠',
                html: `
                    <div class="space-y-4">
                        <div class="flex items-center justify-between">
                            <span>Google Sheets:</span>
                            <span id="test-sheets-status" class="text-yellow-600">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö...</span>
                        </div>
                        <div class="flex items-center justify-between">
                            <span>Cloudinary:</span>
                            <span id="test-drive-status" class="text-yellow-600">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö...</span>
                        </div>
                        <div class="mt-4 text-sm text-gray-600">
                            <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö Google Services...</p>
                        </div>
                    </div>
                `,
                allowOutsideClick: false,
                showConfirmButton: false,
                didOpen: () => {
                    // Test connections with detailed feedback
                    testConnectionsDetailed();
                }
            });
        }

        async function testConnectionsDetailed() {
            let sheetsStatus = false;
            let driveStatus = false;
            
            try {
                // Test comprehensive API endpoints
                document.getElementById('test-sheets-status').textContent = '‡∏ó‡∏î‡∏™‡∏≠‡∏ö...';
                
                // Test all available actions
                const testActions = ['testAll', 'quickTest', 'healthCheck', 'loadWorkers'];
                let successfulTests = 0;
                
                for (const action of testActions) {
                    try {
                        const response = await testAPIEndpoint(action);
                        if (response && response.status === 'success') {
                            successfulTests++;
                        }
                    } catch (error) {
                        console.warn(`Test ${action} failed:`, error);
                    }
                }
                
                if (successfulTests > 0) {
                    document.getElementById('test-sheets-status').textContent = `‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (${successfulTests}/${testActions.length})`;
                    document.getElementById('test-sheets-status').className = 'text-green-600';
                    sheetsStatus = true;
                } else {
                    document.getElementById('test-sheets-status').textContent = '‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß';
                    document.getElementById('test-sheets-status').className = 'text-red-600';
                }
                
            } catch (error) {
                document.getElementById('test-sheets-status').textContent = '‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß';
                document.getElementById('test-sheets-status').className = 'text-red-600';
            }

            try {
                // Test Cloudinary connection
                document.getElementById('test-drive-status').textContent = '‡∏ó‡∏î‡∏™‡∏≠‡∏ö...';
                
                const driveTest = await testCloudinaryConnection();
                
                if (driveTest && driveTest.status === 'success') {
                    document.getElementById('test-drive-status').textContent = '‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à';
                    document.getElementById('test-drive-status').className = 'text-green-600';
                    driveStatus = true;
                } else {
                    document.getElementById('test-drive-status').textContent = '‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß';
                    document.getElementById('test-drive-status').className = 'text-red-600';
                }
                
            } catch (error) {
                document.getElementById('test-drive-status').textContent = '‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß';
                document.getElementById('test-drive-status').className = 'text-red-600';
            }

            // Show final results
            setTimeout(() => {
                if (sheetsStatus && driveStatus) {
                    Swal.fire({
                        icon: 'success',
                        title: '‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏õ‡∏Å‡∏ï‡∏¥ ‚úÖ',
                        html: `
                            <div class="text-left space-y-3">
                                <div class="bg-green-50 p-4 rounded-lg">
                                    <p class="text-green-800 font-semibold mb-2">üéâ ‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô!</p>
                                    <ul class="text-sm text-green-700 space-y-1">
                                        <li>‚úÖ Google Sheets API: ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥</li>
                                        <li>‚úÖ Cloudinary API: ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥</li>
                                        <li>‚úÖ ‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û: ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</li>
                                        <li>‚úÖ ‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•: ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</li>
                                    </ul>
                                </div>
                                <div class="text-center">
                                    <p class="text-sm text-gray-600">‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏î‡πâ‡πÅ‡∏•‡πâ‡∏ß</p>
                                </div>
                            </div>
                        `,
                        confirmButtonText: '‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô',
                        confirmButtonColor: '#10b981'
                    });
                } else {
                    Swal.fire({
                        icon: 'warning',
                        title: '‡∏û‡∏ö‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ ‚ö†Ô∏è',
                        html: `
                            <div class="text-left space-y-3">
                                <div class="space-y-2">
                                    <p class="${sheetsStatus ? 'text-green-600' : 'text-red-600'}">
                                        ${sheetsStatus ? '‚úÖ' : '‚ùå'} Google Sheets: ${sheetsStatus ? '‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à' : '‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß'}
                                    </p>
                                    <p class="${driveStatus ? 'text-green-600' : 'text-red-600'}">
                                        ${driveStatus ? '‚úÖ' : '‚ùå'} Cloudinary: ${driveStatus ? '‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à' : '‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß'}
                                    </p>
                                </div>
                                
                                <div class="bg-yellow-50 p-4 rounded-lg">
                                    <p class="text-yellow-800 font-semibold mb-2">üîß ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:</p>
                                    <ul class="text-sm text-yellow-700 space-y-1">
                                        <li>1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö URL ‡∏Ç‡∏≠‡∏á Google Apps Script</li>
                                        <li>2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Cloudinary Cloud Name ‡πÅ‡∏•‡∏∞ Upload Preset</li>
                                        <li>3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Cloudinary Account</li>
                                        <li>4. ‡∏•‡∏≠‡∏á‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡πÅ‡∏•‡∏∞‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÉ‡∏´‡∏°‡πà</li>
                                    </ul>
                                </div>
                                
                                ${sheetsStatus ? '<div class="bg-blue-50 p-3 rounded-lg"><p class="text-sm text-blue-800">üí° ‡∏£‡∏∞‡∏ö‡∏ö‡∏¢‡∏±‡∏á‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ ‡πÅ‡∏ï‡πà‡∏≠‡∏≤‡∏à‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÑ‡∏î‡πâ</p></div>' : ''}
                            </div>
                        `,
                        confirmButtonText: '‡∏õ‡∏¥‡∏î',
                        confirmButtonColor: '#f59e0b'
                    });
                }
            }, 1000);

            // Update main connection status
            checkConnections();
        }

        // New comprehensive API testing function
        async function testAPIEndpoint(action) {
            return new Promise((resolve, reject) => {
                const callbackName = `test_${action}_${Date.now()}_${Math.round(100000 * Math.random())}`;
                const script = document.createElement('script');
                script.id = `test_script_${callbackName}`;
                
                const params = new URLSearchParams({
                    action: action,
                    callback: callbackName,
                    timestamp: Date.now()
                });
                
                script.src = `${SHEET_URL}?${params.toString()}`;
                
                window[callbackName] = function(response) {
                    // Cleanup
                    try {
                        if (document.getElementById(script.id)) {
                            document.head.removeChild(script);
                        }
                    } catch (cleanupError) {
                        console.warn('Script cleanup error:', cleanupError);
                    }
                    delete window[callbackName];
                    
                    if (response && response.status === 'success') {
                        resolve(response);
                    } else {
                        reject(new Error(response?.message || `Test ${action} failed`));
                    }
                };
                
                script.onerror = function(error) {
                    // Cleanup
                    try {
                        if (document.getElementById(script.id)) {
                            document.head.removeChild(script);
                        }
                    } catch (cleanupError) {
                        console.warn('Script cleanup error:', cleanupError);
                    }
                    delete window[callbackName];
                    reject(new Error(`Network error testing ${action}`));
                };
                
                document.head.appendChild(script);
                
                // Timeout for each test
                setTimeout(() => {
                    if (window[callbackName]) {
                        try {
                            if (document.getElementById(script.id)) {
                                document.head.removeChild(script);
                            }
                        } catch (cleanupError) {
                            console.warn('Script cleanup error:', cleanupError);
                        }
                        delete window[callbackName];
                        reject(new Error(`Timeout testing ${action}`));
                    }
                }, 10000);
            });
        }

        function setupEventListeners() {
            // Language toggle
            document.getElementById('langToggle').addEventListener('click', toggleLanguage);
            
            // Navigation
            document.getElementById('startBtn').addEventListener('click', showMainSystem);
            if (document.getElementById('aboutBtn')) {
                document.getElementById('aboutBtn').addEventListener('click', showAboutModal);
            }
            if (document.getElementById('addWorkerBtn')) {
                document.getElementById('addWorkerBtn').addEventListener('click', showWorkerForm);
            }
            if (document.getElementById('adminBtn')) {
                document.getElementById('adminBtn').addEventListener('click', showAdminPanel);
            }
            
            // Form handling
            if (document.getElementById('workerForm')) {
                document.getElementById('workerForm').addEventListener('submit', handleFormSubmit);
                document.getElementById('closeFormBtn').addEventListener('click', hideWorkerForm);
                document.getElementById('cancelBtn').addEventListener('click', hideWorkerForm);
            }
            
            // Detail modal
            if (document.getElementById('closeDetailBtn')) {
                document.getElementById('closeDetailBtn').addEventListener('click', hideWorkerDetail);
            }
            
            // Admin panel
            if (document.getElementById('closeAdminBtn')) {
                document.getElementById('closeAdminBtn').addEventListener('click', hideAdminPanel);
                document.getElementById('adminLoginBtn').addEventListener('click', handleAdminLogin);
                document.getElementById('manageFormBtn').addEventListener('click', showFormManagement);
                document.getElementById('editContentBtn').addEventListener('click', showContentEditor);
                document.getElementById('exportBtn').addEventListener('click', exportToExcel);
                document.getElementById('resetSheetBtn').addEventListener('click', resetSheet);
                document.getElementById('testUploadBtn').addEventListener('click', runPhotoUploadTest);
            }
            
            // Form management
            if (document.getElementById('closeFormManagementBtn')) {
                document.getElementById('closeFormManagementBtn').addEventListener('click', hideFormManagement);
            }
            if (document.getElementById('closeContentEditorBtn')) {
                document.getElementById('closeContentEditorBtn').addEventListener('click', hideContentEditor);
            }
            if (document.getElementById('closeQuestionEditorBtn')) {
                document.getElementById('closeQuestionEditorBtn').addEventListener('click', hideQuestionEditor);
            }
            
            // Enhanced form management
            if (document.getElementById('addFieldBtn')) {
                document.getElementById('addFieldBtn').addEventListener('click', showQuestionEditor);
            }
            if (document.getElementById('editFormThai')) {
                document.getElementById('editFormThai').addEventListener('click', () => setFormEditLanguage('th'));
            }
            if (document.getElementById('editFormChinese')) {
                document.getElementById('editFormChinese').addEventListener('click', () => setFormEditLanguage('zh'));
            }
            if (document.getElementById('questionEditorForm')) {
                document.getElementById('questionEditorForm').addEventListener('submit', handleQuestionSave);
                document.getElementById('cancelQuestionBtn').addEventListener('click', hideQuestionEditor);
                document.getElementById('questionType').addEventListener('change', handleQuestionTypeChange);
                document.getElementById('addOptionBtn').addEventListener('click', addQuestionOption);
            }
            
            // Search and filter
            if (document.getElementById('searchInput')) {
                document.getElementById('searchInput').addEventListener('input', filterWorkers);
                document.getElementById('genderFilter').addEventListener('change', filterWorkers);
                document.getElementById('statusFilter').addEventListener('change', filterWorkers);
                document.getElementById('refreshBtn').addEventListener('click', loadWorkersData);
            }
            
            // Photo preview
            if (document.getElementById('photo')) {
                document.getElementById('photo').addEventListener('change', handlePhotoPreview);
            }
            
            // Dynamic form fields
            setupDynamicFields();
        }

        function showAboutModal() {
            Swal.fire({
                title: currentLanguage === 'th' ? '‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÄ‡∏£‡∏≤' : 'ÈóúÊñºÊàëÂÄë',
                html: `
                    <div class="text-left space-y-4">
                        <p class="text-gray-600">
                            ${currentLanguage === 'th' 
                                ? '„ÄåÂú®Âú∞Âπ´Âπ´Â∑•„Äç‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏û‡∏•‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ô‡∏≤‡∏¢‡∏à‡πâ‡∏≤‡∏á‡∏Å‡∏±‡∏ö‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡∏Å‡∏≤‡∏£‡∏´‡∏≤‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏´‡∏≤‡∏Ñ‡∏ô‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û'
                                : '„ÄåÂú®Âú∞Âπ´Âπ´Â∑•„ÄçÊòØ‰∏ÄÂÄãÈÄ£Êé•Èõá‰∏ªËàáÁï∂Âú∞Âπ´Â∑•ÁöÑÂπ≥Âè∞ÔºåÂπ´Âä©ÊèêÈ´òÊâæÂ∑•‰ΩúÂíåÊâæ‰∫∫ÊâçÁöÑÊïàÁéá'
                            }
                        </p>
                        <div class="bg-blue-50 p-4 rounded-lg">
                            <h4 class="font-semibold text-blue-800 mb-2">
                                ${currentLanguage === 'th' ? '‚ú® ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥‡∏´‡∏•‡∏±‡∏Å' : '‚ú® ‰∏ªË¶ÅÂäüËÉΩ'}
                            </h4>
                            <ul class="text-sm text-blue-700 space-y-1">
                                <li>‚Ä¢ ${currentLanguage === 'th' ? '‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô' : 'Âπ´Â∑•Ë≥áÊñôÁÆ°ÁêÜÁ≥ªÁµ±'}</li>
                                <li>‚Ä¢ ${currentLanguage === 'th' ? '‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏´‡∏•‡∏≤‡∏¢‡∏†‡∏≤‡∏©‡∏≤ (‡πÑ‡∏ó‡∏¢/‡∏à‡∏µ‡∏ô)' : 'Â§öË™ûË®ÄÊîØÊè¥ (Ê≥∞Ë™û/‰∏≠Êñá)'}</li>
                                <li>‚Ä¢ ${currentLanguage === 'th' ? '‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Google Sheets ‡πÅ‡∏•‡∏∞ Drive' : 'ÈÄ£Êé• Google Sheets Âíå Drive'}</li>
                                <li>‚Ä¢ ${currentLanguage === 'th' ? '‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÅ‡∏•‡∏∞‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•' : 'ÊêúÁ¥¢ÂíåÁØ©ÈÅ∏Á≥ªÁµ±'}</li>
                            </ul>
                        </div>
                    </div>
                `,
                width: '600px',
                confirmButtonText: currentLanguage === 'th' ? '‡∏õ‡∏¥‡∏î' : 'ÈóúÈñâ',
                confirmButtonColor: '#667eea'
            });
        }

        function setupDynamicFields() {
            // Gender other field
            document.getElementById('gender').addEventListener('change', function() {
                const otherField = document.getElementById('genderOther');
                if (this.value === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ') {
                    otherField.classList.remove('hidden');
                    otherField.required = true;
                } else {
                    otherField.classList.add('hidden');
                    otherField.required = false;
                    otherField.value = '';
                }
            });
            
            // Work status other field
            document.getElementById('workStatus').addEventListener('change', function() {
                const otherField = document.getElementById('statusOther');
                if (this.value === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ') {
                    otherField.classList.remove('hidden');
                    otherField.required = true;
                } else {
                    otherField.classList.add('hidden');
                    otherField.required = false;
                    otherField.value = '';
                }
            });
            
            // ID type other field
            document.getElementById('idType').addEventListener('change', function() {
                const otherField = document.getElementById('idTypeOther');
                if (this.value === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ') {
                    otherField.classList.remove('hidden');
                    otherField.required = true;
                } else {
                    otherField.classList.add('hidden');
                    otherField.required = false;
                    otherField.value = '';
                }
            });
            
            // Interested jobs other field
            document.getElementById('interestedOtherCheck').addEventListener('change', function() {
                const otherField = document.getElementById('interestedOther');
                if (this.checked) {
                    otherField.classList.remove('hidden');
                    otherField.required = true;
                } else {
                    otherField.classList.add('hidden');
                    otherField.required = false;
                    otherField.value = '';
                }
            });
            
            // Skills other field
            document.getElementById('skillsOtherCheck').addEventListener('change', function() {
                const otherField = document.getElementById('skillsOther');
                if (this.checked) {
                    otherField.classList.remove('hidden');
                    otherField.required = true;
                } else {
                    otherField.classList.add('hidden');
                    otherField.required = false;
                    otherField.value = '';
                }
            });
            
            // Language other field
            document.getElementById('languageOtherCheck').addEventListener('change', function() {
                const otherField = document.getElementById('languageOther');
                if (this.checked) {
                    otherField.classList.remove('hidden');
                    otherField.required = true;
                } else {
                    otherField.classList.add('hidden');
                    otherField.required = false;
                    otherField.value = '';
                }
            });
        }

        function toggleLanguage() {
            currentLanguage = currentLanguage === 'th' ? 'zh' : 'th';
            updateLanguage();
        }

        function updateLanguage() {
            const langText = document.getElementById('langText');
            langText.textContent = currentLanguage === 'th' ? '‰∏≠Êñá' : '‡πÑ‡∏ó‡∏¢';
            
            // Update all translatable elements
            Object.keys(translations[currentLanguage]).forEach(key => {
                const element = document.getElementById(key);
                if (element) {
                    element.textContent = translations[currentLanguage][key];
                }
            });
            
            // Update placeholders and other attributes
            updatePlaceholders();
        }

        function updatePlaceholders() {
            // Update search placeholder
            if (currentLanguage === 'zh') {
                document.getElementById('searchInput').placeholder = 'ÊêúÁ¥¢ÂßìÂêçÊàñÂ∑•‰ΩúÁ∑®Ëôü';
            } else {
                document.getElementById('searchInput').placeholder = '‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏´‡∏±‡∏™‡∏á‡∏≤‡∏ô';
            }
            
            // Update filter options
            updateFilterOptions();
            
            // Update form options
            updateFormOptions();
        }

        function updateFilterOptions() {
            if (currentLanguage === 'zh') {
                document.querySelector('#genderFilter option[value=""]').textContent = 'ÊâÄÊúâÊÄßÂà•';
                document.querySelector('#genderFilter option[value="‡∏ä‡∏≤‡∏¢"]').textContent = 'Áî∑';
                document.querySelector('#genderFilter option[value="‡∏´‡∏ç‡∏¥‡∏á"]').textContent = 'Â•≥';
                document.querySelector('#genderFilter option[value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ"]').textContent = 'ÂÖ∂‰ªñ';
                document.querySelector('#statusFilter option[value=""]').textContent = 'ÊâÄÊúâÁãÄÊÖã';
                document.querySelector('#statusFilter option[value="‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô"]').textContent = 'ÂèØÂ∑•‰Ωú';
                document.querySelector('#statusFilter option[value="‡πÑ‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô"]').textContent = '‰∏çÂèØÂ∑•‰Ωú';
                document.querySelector('#statusFilter option[value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ"]').textContent = 'ÂÖ∂‰ªñ';
            } else {
                document.querySelector('#genderFilter option[value=""]').textContent = '‡∏ó‡∏∏‡∏Å‡πÄ‡∏û‡∏®';
                document.querySelector('#genderFilter option[value="‡∏ä‡∏≤‡∏¢"]').textContent = '‡∏ä‡∏≤‡∏¢';
                document.querySelector('#genderFilter option[value="‡∏´‡∏ç‡∏¥‡∏á"]').textContent = '‡∏´‡∏ç‡∏¥‡∏á';
                document.querySelector('#genderFilter option[value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ"]').textContent = '‡∏≠‡∏∑‡πà‡∏ô‡πÜ';
                document.querySelector('#statusFilter option[value=""]').textContent = '‡∏ó‡∏∏‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞';
                document.querySelector('#statusFilter option[value="‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô"]').textContent = '‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô';
                document.querySelector('#statusFilter option[value="‡πÑ‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô"]').textContent = '‡πÑ‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô';
                document.querySelector('#statusFilter option[value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ"]').textContent = '‡∏≠‡∏∑‡πà‡∏ô‡πÜ';
            }
        }

        function updateFormOptions() {
            // Update gender options
            const genderSelect = document.getElementById('gender');
            if (genderSelect) {
                const options = genderSelect.querySelectorAll('option');
                if (currentLanguage === 'zh') {
                    options[0].textContent = 'ÈÅ∏ÊìáÊÄßÂà•';
                    options[1].textContent = 'Áî∑';
                    options[2].textContent = 'Â•≥';
                    options[3].textContent = 'ÂÖ∂‰ªñ';
                } else {
                    options[0].textContent = '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏û‡∏®';
                    options[1].textContent = '‡∏ä‡∏≤‡∏¢';
                    options[2].textContent = '‡∏´‡∏ç‡∏¥‡∏á';
                    options[3].textContent = '‡∏≠‡∏∑‡πà‡∏ô‡πÜ';
                }
            }

            // Update transport options
            const transportSelect = document.getElementById('transport');
            if (transportSelect) {
                const options = transportSelect.querySelectorAll('option');
                if (currentLanguage === 'zh') {
                    options[0].textContent = 'ÈÅ∏Êìá';
                    options[1].textContent = 'ÂèØ‰ª•';
                    options[2].textContent = '‰∏çÂèØ‰ª•';
                } else {
                    options[0].textContent = '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å';
                    options[1].textContent = '‡πÑ‡∏î‡πâ';
                    options[2].textContent = '‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ';
                }
            }

            // Update work status options
            const workStatusSelect = document.getElementById('workStatus');
            if (workStatusSelect) {
                const options = workStatusSelect.querySelectorAll('option');
                if (currentLanguage === 'zh') {
                    options[0].textContent = 'ÈÅ∏ÊìáÁãÄÊÖã';
                    options[1].textContent = 'ÂèØÂ∑•‰Ωú';
                    options[2].textContent = '‰∏çÂèØÂ∑•‰Ωú';
                    options[3].textContent = 'ÂÖ∂‰ªñ';
                } else {
                    options[0].textContent = '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞';
                    options[1].textContent = '‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô';
                    options[2].textContent = '‡πÑ‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô';
                    options[3].textContent = '‡∏≠‡∏∑‡πà‡∏ô‡πÜ';
                }
            }

            // Update ID type options
            const idTypeSelect = document.getElementById('idType');
            if (idTypeSelect) {
                const options = idTypeSelect.querySelectorAll('option');
                if (currentLanguage === 'zh') {
                    options[0].textContent = 'ÈÅ∏ÊìáÈ°ûÂûã';
                    options[1].textContent = 'Ê≥∞ÂúãË∫´‰ªΩË≠â';
                    options[2].textContent = 'Â§ñÂúã‰∫∫Ë∫´‰ªΩË≠â';
                    options[3].textContent = 'ÁÑ°Ë∫´‰ªΩË≠â';
                    options[4].textContent = 'ÂÖ∂‰ªñ';
                } else {
                    options[0].textContent = '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó';
                    options[1].textContent = '‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡πÑ‡∏ó‡∏¢';
                    options[2].textContent = '‡∏ö‡∏±‡∏ï‡∏£‡∏ï‡πà‡∏≤‡∏á‡∏î‡πâ‡∏≤‡∏ß';
                    options[3].textContent = '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ö‡∏±‡∏ï‡∏£';
                    options[4].textContent = '‡∏≠‡∏∑‡πà‡∏ô‡πÜ';
                }
            }

            // Update checkbox labels
            updateCheckboxLabels();
        }

        function updateCheckboxLabels() {
            const checkboxSections = [
                { containerId: 'interestedJobs', options: formFields.find(f => f.id === 'interestedJobs')?.options || [] },
                { containerId: 'skills', options: formFields.find(f => f.id === 'skills')?.options || [] },
                { containerId: 'languages', options: formFields.find(f => f.id === 'languages')?.options || [] }
            ];

            checkboxSections.forEach(section => {
                const container = document.getElementById(section.containerId);
                if (container) {
                    const labels = container.querySelectorAll('label');
                    labels.forEach((label, index) => {
                        if (section.options[index]) {
                            const span = label.querySelector('span') || label.childNodes[label.childNodes.length - 1];
                            if (span && span.textContent) {
                                const optionData = section.options[index];
                                if (optionData && optionData.label) {
                                    span.textContent = optionData.label[currentLanguage] || span.textContent;
                                }
                            }
                        }
                    });
                }
            });
        }

        function showMainSystem() {
            document.getElementById('landingPage').classList.add('hidden');
            document.getElementById('mainSystem').classList.remove('hidden');
        }

        function showWorkerForm() {
            document.getElementById('workerFormModal').classList.remove('hidden');
            resetForm();
        }

        function hideWorkerForm() {
            document.getElementById('workerFormModal').classList.add('hidden');
        }

        function showWorkerDetail(worker) {
            const modal = document.getElementById('workerDetailModal');
            const content = document.getElementById('workerDetailContent');
            
            const firstName = worker.fullName.split(' ')[0];
            
            // Enhanced photo display for detail view with loading states
            let photoElement;
            if (worker.photoUrl && worker.photoUrl.trim() !== '' && worker.photoUrl !== 'undefined' && worker.photoUrl !== 'null') {
                console.log('üñºÔ∏è Displaying detail photo for worker:', worker.workerId, 'URL:', worker.photoUrl);
                
                // Use Cloudinary URL directly (no conversion needed)
                const directUrl = worker.photoUrl;
                
                photoElement = `
                    <div class="w-32 h-32 mx-auto mb-4 relative">
                        <div class="w-32 h-32 bg-gray-100 rounded-full flex items-center justify-center absolute top-0 left-0 animate-pulse">
                            <div class="w-12 h-12 bg-gray-300 rounded-full"></div>
                        </div>
                        <img src="${directUrl}" 
                             class="w-32 h-32 object-cover rounded-full border-4 border-primary shadow-lg relative z-10" 
                             onerror="console.error('‚ùå Detail image load failed for ${worker.workerId}:', this.src); this.style.display='none'; this.nextElementSibling.style.display='flex';"
                             onload="console.log('‚úÖ Detail image loaded for ${worker.workerId}'); this.previousElementSibling.style.display='none'; this.nextElementSibling.style.display='none';">
                        <div class="w-32 h-32 bg-gradient-to-br from-gray-200 to-gray-300 rounded-full flex items-center justify-center text-4xl absolute top-0 left-0 z-10 shadow-inner" style="display: none;">
                            <span class="text-gray-500">üë§</span>
                        </div>
                    </div>`;
            } else {
                console.log('üì∑ No photo URL for detail view:', worker.workerId, 'photoUrl:', worker.photoUrl);
                photoElement = `
                    <div class="w-32 h-32 bg-gradient-to-br from-gray-200 to-gray-300 rounded-full mx-auto mb-4 flex items-center justify-center text-4xl shadow-inner">
                        <span class="text-gray-500">üë§</span>
                    </div>`;
            }
            
            content.innerHTML = `
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="text-center md:col-span-2">
                        ${photoElement}
                        <h3 class="text-2xl font-bold text-primary">${firstName}</h3>
                        <p class="text-gray-600">${worker.workerId}</p>
                    </div>
                    
                    <div><strong>‡∏≠‡∏≤‡∏¢‡∏∏:</strong> ${worker.age} ‡∏õ‡∏µ</div>
                    <div><strong>‡πÄ‡∏û‡∏®:</strong> ${worker.gender}</div>
                    <div><strong>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£:</strong> ${worker.phone}</div>
                    <div><strong>LINE ID:</strong> ${worker.lineId || '-'}</div>
                    <div><strong>Facebook:</strong> ${worker.facebook || '-'}</div>
                    <div><strong>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</strong> ${worker.workStatus}</div>
                    <div><strong>‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡πÑ‡∏î‡πâ‡πÄ‡∏≠‡∏á:</strong> ${worker.transport}</div>
                    <div><strong>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ:</strong> ${worker.startDate || '-'}</div>
                    <div class="md:col-span-2"><strong>‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà:</strong> ${worker.address}</div>
                    <div class="md:col-span-2"><strong>‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Å‡∏≤‡∏£‡∏ì‡πå:</strong> ${worker.experience}</div>
                    <div class="md:col-span-2"><strong>‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏ô‡πÉ‡∏à:</strong> ${worker.interestedJobs}</div>
                    <div class="md:col-span-2"><strong>‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÑ‡∏î‡πâ:</strong> ${worker.skills}</div>
                    <div class="md:col-span-2"><strong>‡∏†‡∏≤‡∏©‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£‡πÑ‡∏î‡πâ:</strong> ${worker.languages}</div>
                    <div class="md:col-span-2"><strong>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ö‡∏±‡∏ï‡∏£:</strong> ${worker.idType}</div>
                    <div class="md:col-span-2"><strong>‡πÇ‡∏£‡∏Ñ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß:</strong> ${worker.health || '‡πÑ‡∏°‡πà‡∏°‡∏µ'}</div>
                </div>
            `;
            
            modal.classList.remove('hidden');
        }

        function hideWorkerDetail() {
            document.getElementById('workerDetailModal').classList.add('hidden');
        }

        function showAdminPanel() {
            document.getElementById('adminPanel').classList.remove('hidden');
            document.getElementById('adminLogin').classList.remove('hidden');
            document.getElementById('adminDashboard').classList.add('hidden');
        }

        function hideAdminPanel() {
            document.getElementById('adminPanel').classList.add('hidden');
        }

        function handleAdminLogin() {
            const password = document.getElementById('adminPassword').value;
            if (password === ADMIN_PASSWORD) {
                document.getElementById('adminLogin').classList.add('hidden');
                document.getElementById('adminDashboard').classList.remove('hidden');
                loadAdminDashboard();
            } else {
                Swal.fire({
                    icon: 'error',
                    title: '‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á',
                    text: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á'
                });
            }
        }

        function loadAdminDashboard() {
            // Update statistics
            const totalWorkers = workersData.length;
            const availableWorkers = workersData.filter(w => w.workStatus === '‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô').length;
            const recentWorkers = workersData.filter(w => {
                const workerDate = new Date(w.timestamp);
                const weekAgo = new Date();
                weekAgo.setDate(weekAgo.getDate() - 7);
                return workerDate >= weekAgo;
            }).length;
            
            document.getElementById('totalWorkers').textContent = totalWorkers;
            document.getElementById('availableWorkers').textContent = availableWorkers;
            document.getElementById('recentWorkers').textContent = recentWorkers;
            
            // Update admin connection status
            updateAdminConnectionStatus();
            
            // Load workers list for admin
            loadAdminWorkersList();
        }

        function updateAdminConnectionStatus() {
            // Get current status from admin panel elements
            const adminSheetStatus = document.getElementById('adminSheetStatus');
            const adminDriveStatus = document.getElementById('adminDriveStatus');
            const adminConnectionStatus = document.getElementById('adminConnectionStatus');
            
            if (!adminSheetStatus || !adminDriveStatus || !adminConnectionStatus) return;
            
            const sheetStatus = adminSheetStatus.textContent;
            const driveStatus = adminDriveStatus.textContent;
            
            // Update overall connection status
            const overallStatus = (sheetStatus === '‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÅ‡∏•‡πâ‡∏ß' && driveStatus === '‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÅ‡∏•‡πâ‡∏ß') 
                ? '‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏õ‡∏Å‡∏ï‡∏¥' 
                : '‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠';
            
            adminConnectionStatus.textContent = overallStatus;
            adminConnectionStatus.className = overallStatus === '‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏õ‡∏Å‡∏ï‡∏¥' 
                ? 'text-green-600' 
                : 'text-red-600';
        }

        function loadAdminWorkersList() {
            const container = document.getElementById('adminWorkersList');
            container.innerHTML = '';
            
            workersData.forEach(worker => {
                const workerDiv = document.createElement('div');
                workerDiv.className = 'bg-gray-50 p-4 rounded-lg flex justify-between items-center';
                workerDiv.innerHTML = `
                    <div>
                        <h4 class="font-semibold">${worker.fullName} (${worker.workerId})</h4>
                        <p class="text-sm text-gray-600">${worker.phone} | ${worker.workStatus}</p>
                    </div>
                    <div class="space-x-2">
                        <button onclick="editWorker('${worker.workerId}')" class="bg-blue-500 text-white px-3 py-1 rounded text-sm hover:bg-blue-600">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
                        <button onclick="deleteWorker('${worker.workerId}')" class="bg-red-500 text-white px-3 py-1 rounded text-sm hover:bg-red-600">‡∏•‡∏ö</button>
                    </div>
                `;
                container.appendChild(workerDiv);
            });
        }

        function resetForm() {
            document.getElementById('workerForm').reset();
            document.getElementById('photoPreview').classList.add('hidden');
            
            // Hide all "other" fields
            document.getElementById('genderOther').classList.add('hidden');
            document.getElementById('statusOther').classList.add('hidden');
            document.getElementById('idTypeOther').classList.add('hidden');
            document.getElementById('interestedOther').classList.add('hidden');
            document.getElementById('skillsOther').classList.add('hidden');
            document.getElementById('languageOther').classList.add('hidden');
        }

        function handlePhotoPreview(event) {
            const file = event.target.files[0];
            const preview = document.getElementById('photoPreview');
            const previewImg = document.getElementById('previewImg');
            
            if (file) {
                if (file.size > 2 * 1024 * 1024) {
                    Swal.fire({
                        icon: 'error',
                        title: '‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡∏ç‡πà‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ',
                        text: `‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 2MB (‡∏Ç‡∏ô‡∏≤‡∏î‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô: ${(file.size / 1024 / 1024).toFixed(2)}MB)`
                    });
                    event.target.value = '';
                    preview.classList.add('hidden');
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    previewImg.src = e.target.result;
                    preview.classList.remove('hidden');
                };
                reader.readAsDataURL(file);
            } else {
                preview.classList.add('hidden');
            }
        }

        function getSelectedCheckboxValues(containerId) {
            const container = document.getElementById(containerId);
            const checkboxes = container.querySelectorAll('input[type="checkbox"]:checked');
            const values = [];
            
            checkboxes.forEach(checkbox => {
                if (checkbox.value === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ') {
                    const otherInput = document.getElementById(containerId.replace('s', '') + 'Other');
                    if (otherInput && otherInput.value.trim()) {
                        values.push(otherInput.value.trim());
                    }
                } else {
                    values.push(checkbox.value);
                }
            });
            
            return values.join(', ');
        }

        async function handleFormSubmit(event) {
            event.preventDefault();
            
            // Show loading with progress
            Swal.fire({
                title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...',
                html: `
                    <div class="text-center">
                        <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary mb-4"></div>
                        <p class="text-gray-600">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà</p>
                        <div class="mt-4 bg-gray-200 rounded-full h-2">
                            <div id="progressBar" class="bg-primary h-2 rounded-full transition-all duration-300" style="width: 10%"></div>
                        </div>
                        <p id="progressText" class="text-sm text-gray-500 mt-2">‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>
                    </div>
                `,
                allowOutsideClick: false,
                showConfirmButton: false
            });
            
            // Disable submit button
            const submitBtn = document.getElementById('submitBtn');
            submitBtn.disabled = true;
            
            try {
                // Update progress
                updateProgress(20, '‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ü‡∏≠‡∏£‡πå‡∏°...');
                
                // Collect form data
                const formData = {
                    action: 'addWorker',
                    workerId: `W${String(workerCounter).padStart(3, '0')}`,
                    fullName: document.getElementById('fullName').value,
                    age: document.getElementById('age').value,
                    address: document.getElementById('address').value,
                    phone: document.getElementById('phone').value,
                    lineId: document.getElementById('lineId').value,
                    facebook: document.getElementById('facebook').value,
                    gender: document.getElementById('gender').value === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ' ? document.getElementById('genderOther').value : document.getElementById('gender').value,
                    experience: document.getElementById('experience').value,
                    transport: document.getElementById('transport').value,
                    workStatus: document.getElementById('workStatus').value === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ' ? document.getElementById('statusOther').value : document.getElementById('workStatus').value,
                    startDate: document.getElementById('startDate').value,
                    idType: document.getElementById('idType').value === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ' ? document.getElementById('idTypeOther').value : document.getElementById('idType').value,
                    health: document.getElementById('health').value,
                    interestedJobs: getSelectedCheckboxValues('interestedJobs'),
                    skills: getSelectedCheckboxValues('skills'),
                    languages: getSelectedCheckboxValues('languages'),
                    photoUrl: '', // Will be updated after photo upload
                    timestamp: new Date().toISOString()
                };
                
                // Validate required multi-select fields
                if (!formData.interestedJobs) {
                    throw new Error('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏ô‡πÉ‡∏à‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 ‡∏≠‡∏¢‡πà‡∏≤‡∏á');
                }
                if (!formData.skills) {
                    throw new Error('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 ‡∏≠‡∏¢‡πà‡∏≤‡∏á');
                }
                if (!formData.languages) {
                    throw new Error('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏†‡∏≤‡∏©‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 ‡∏†‡∏≤‡∏©‡∏≤');
                }
                
                updateProgress(40, '‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...');
                
                // Handle photo upload with enhanced error handling
                const photoFile = document.getElementById('photo').files[0];
                if (photoFile) {
                    try {
                        updateProgress(50, '‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û...');
                        console.log('üì§ Starting enhanced photo upload for:', formData.workerId, 'File:', photoFile.name, 'Size:', photoFile.size);
                        
                        const photoUrl = await uploadPhotoToGoogleDrive(photoFile, formData.workerId);
                        
                        if (photoUrl && photoUrl.trim() !== '' && photoUrl !== 'undefined' && photoUrl !== 'null') {
                            formData.photoUrl = photoUrl;
                            console.log('‚úÖ Photo upload successful, URL:', photoUrl);
                            updateProgress(70, '‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                        } else {
                            console.warn('‚ö†Ô∏è Photo upload returned invalid URL:', photoUrl);
                            throw new Error('‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö URL ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á');
                        }
                    } catch (photoError) {
                        console.error('‚ùå Photo upload failed:', photoError);
                        
                        // Show detailed error dialog with options
                        const result = await Swal.fire({
                            icon: 'error',
                            title: '‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß ‚ùå',
                            html: `
                                <div class="text-left space-y-4">
                                    <div class="bg-red-50 p-4 rounded-lg">
                                        <p class="text-red-800 font-semibold mb-2">üö´ ‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏:</p>
                                        <p class="text-sm text-red-700">${photoError.message}</p>
                                    </div>
                                    
                                    <div class="bg-blue-50 p-4 rounded-lg">
                                        <p class="text-blue-800 font-semibold mb-2">üí° ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:</p>
                                        <ul class="text-sm text-blue-700 space-y-1">
                                            <li>‚Ä¢ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏ü‡∏•‡πå (‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 2MB)</li>
                                            <li>‚Ä¢ ‡πÉ‡∏ä‡πâ‡πÑ‡∏ü‡∏•‡πå .jpg, .jpeg ‡∏´‡∏£‡∏∑‡∏≠ .png ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</li>
                                            <li>‚Ä¢ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏≠‡∏¥‡∏ô‡πÄ‡∏ó‡∏≠‡∏£‡πå‡πÄ‡∏ô‡πá‡∏ï</li>
                                            <li>‚Ä¢ ‡∏•‡∏≠‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÉ‡∏´‡∏°‡πà</li>
                                        </ul>
                                    </div>
                                    
                                    <div class="bg-yellow-50 p-4 rounded-lg">
                                        <p class="text-yellow-800 font-semibold mb-2">‚ö†Ô∏è ‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£?</p>
                                        <p class="text-sm text-yellow-700">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á</p>
                                    </div>
                                </div>
                            `,
                            showCancelButton: true,
                            showDenyButton: true,
                            confirmButtonText: 'üìù ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ï‡πà‡∏≠ (‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏π‡∏õ)',
                            denyButtonText: 'üîÑ ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà',
                            cancelButtonText: '‚ùå ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å',
                            confirmButtonColor: '#10b981',
                            denyButtonColor: '#f59e0b',
                            cancelButtonColor: '#ef4444',
                            allowOutsideClick: false
                        });
                        
                        if (result.isConfirmed) {
                            // Continue without photo
                            formData.photoUrl = '';
                            updateProgress(70, '‡∏Ç‡πâ‡∏≤‡∏°‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û');
                            console.log('üìù User chose to continue without photo');
                        } else if (result.isDenied) {
                            // Retry photo upload
                            throw new Error('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏•‡∏∞‡∏•‡∏≠‡∏á‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á');
                        } else {
                            // Cancel entire form submission
                            throw new Error('‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•');
                        }
                    }
                } else {
                    updateProgress(70, '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û');
                    console.log('üì∑ No photo file selected');
                }
                
                updateProgress(80, '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á Google Sheets...');
                
                // Send data to Google Sheets using JSONP
                const response = await sendToGoogleSheetsJSONP(formData);
                
                updateProgress(90, '‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...');
                
                if (response && response.status === 'success') {
                    // Add to local data
                    workersData.push(formData);
                    workerCounter++;
                    
                    console.log('üíæ Data saved successfully:', {
                        workerId: formData.workerId,
                        fullName: formData.fullName,
                        photoUrl: formData.photoUrl,
                        hasPhoto: !!formData.photoUrl
                    });
                    
                    // Update display
                    displayWorkers();
                    
                    updateProgress(100, '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
                    
                    // Show success message
                    setTimeout(() => {
                        Swal.fire({
                            icon: 'success',
                            title: '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! üéâ',
                            html: `
                                <div class="text-center">
                                    <div class="text-6xl mb-4">‚úÖ</div>
                                    <p class="text-lg font-semibold text-green-600 mb-2">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡πâ‡∏ß</p>
                                    <div class="bg-green-50 p-4 rounded-lg">
                                        <p class="text-sm text-green-800">
                                            <strong>‡∏£‡∏´‡∏±‡∏™‡∏á‡∏≤‡∏ô:</strong> ${formData.workerId}<br>
                                            <strong>‡∏ä‡∏∑‡πà‡∏≠:</strong> ${formData.fullName}<br>
                                            <strong>‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û:</strong> ${formData.photoUrl ? '‚úÖ ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à' : '‚ùå ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û'}<br>
                                            <strong>‡πÄ‡∏ß‡∏•‡∏≤‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å:</strong> ${new Date().toLocaleString('th-TH')}
                                        </p>
                                    </div>
                                </div>
                            `,
                            confirmButtonText: '‡∏õ‡∏¥‡∏î',
                            confirmButtonColor: '#10b981'
                        });
                    }, 500);
                    
                    // Close form
                    hideWorkerForm();
                } else {
                    throw new Error(response?.message || '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ');
                }
                
            } catch (error) {
                console.error('Error saving worker data:', error);
                Swal.fire({
                    icon: 'error',
                    title: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î! ‚ùå',
                    html: `
                        <div class="text-center">
                            <div class="text-6xl mb-4">‚ö†Ô∏è</div>
                            <p class="text-lg font-semibold text-red-600 mb-2">‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ</p>
                            <div class="bg-red-50 p-4 rounded-lg">
                                <p class="text-sm text-red-800">${error.message}</p>
                            </div>
                            <div class="mt-4 text-xs text-gray-500">
                                <p>‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:</p>
                                <ul class="text-left mt-2 space-y-1">
                                    <li>‚Ä¢ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏≠‡∏¥‡∏ô‡πÄ‡∏ó‡∏≠‡∏£‡πå‡πÄ‡∏ô‡πá‡∏ï</li>
                                    <li>‚Ä¢ ‡∏•‡∏≠‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</li>
                                    <li>‚Ä¢ ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö‡∏´‡∏≤‡∏Å‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏¢‡∏±‡∏á‡∏Ñ‡∏á‡∏≠‡∏¢‡∏π‡πà</li>
                                </ul>
                            </div>
                        </div>
                    `,
                    confirmButtonText: '‡∏•‡∏≠‡∏á‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á',
                    confirmButtonColor: '#ef4444'
                });
            } finally {
                // Re-enable submit button
                submitBtn.disabled = false;
            }
        }
        
        function updateProgress(percentage, text) {
            const progressBar = document.getElementById('progressBar');
            const progressText = document.getElementById('progressText');
            
            if (progressBar) {
                progressBar.style.width = percentage + '%';
            }
            if (progressText) {
                progressText.textContent = text;
            }
        }

        // Enhanced Google Drive Photo Upload System with Multiple Fallback Methods
        async function uploadPhotoToGoogleDrive(file, workerId) {
            return new Promise(async (resolve, reject) => {
                // Validate inputs
                if (!file) {
                    reject(new Error('‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û'));
                    return;
                }
                
                if (!workerId) {
                    reject(new Error('‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏á‡∏≤‡∏ô'));
                    return;
                }
                
                // Check file size (2MB limit for better reliability)
                if (file.size > 2 * 1024 * 1024) {
                    reject(new Error(`‡πÑ‡∏ü‡∏•‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÉ‡∏´‡∏ç‡πà‡πÄ‡∏Å‡∏¥‡∏ô 2MB (‡∏Ç‡∏ô‡∏≤‡∏î‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô: ${(file.size / 1024 / 1024).toFixed(2)}MB)`));
                    return;
                }
                
                // Check file type
                const allowedTypes = ['image/jpeg', 'image/jpg', 'image/png'];
                if (!allowedTypes.includes(file.type)) {
                    reject(new Error('‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÑ‡∏ü‡∏•‡πå .jpg, .jpeg, .png ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô'));
                    return;
                }
                
                console.log('üîÑ Starting enhanced photo upload for worker:', workerId);
                console.log('üìä File details:', {
                    name: file.name,
                    size: file.size,
                    type: file.type
                });
                
                // Try multiple upload methods
                const uploadMethods = [
                    () => uploadViaChunkedUpload(file, workerId),
                    () => uploadViaDirectUpload(file, workerId),
                    () => uploadViaFormData(file, workerId)
                ];
                
                for (let i = 0; i < uploadMethods.length; i++) {
                    try {
                        console.log(`üîÑ Trying upload method ${i + 1}/${uploadMethods.length}`);
                        const result = await uploadMethods[i]();
                        
                        if (result && result.trim() !== '' && result !== 'undefined' && result !== 'null') {
                            console.log(`‚úÖ Upload method ${i + 1} successful:`, result);
                            resolve(result);
                            return;
                        } else {
                            console.warn(`‚ö†Ô∏è Upload method ${i + 1} returned empty result:`, result);
                        }
                    } catch (error) {
                        console.warn(`‚ùå Upload method ${i + 1} failed:`, error.message);
                        if (i === uploadMethods.length - 1) {
                            // Last method failed
                            reject(new Error(`‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß‡∏ó‡∏∏‡∏Å‡∏ß‡∏¥‡∏ò‡∏µ: ${error.message}`));
                        }
                    }
                }
            });
        }
        
        // Method 1: Chunked Upload for large files
        function uploadViaChunkedUpload(file, workerId) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    try {
                        const base64Data = e.target.result.split(',')[1];
                        const chunkSize = 50000; // 50KB chunks
                        const chunks = [];
                        
                        // Split base64 data into chunks
                        for (let i = 0; i < base64Data.length; i += chunkSize) {
                            chunks.push(base64Data.slice(i, i + chunkSize));
                        }
                        
                        console.log(`üì¶ Split file into ${chunks.length} chunks`);
                        
                        // Upload chunks sequentially
                        uploadChunksSequentially(chunks, workerId, file)
                            .then(resolve)
                            .catch(reject);
                            
                    } catch (error) {
                        reject(new Error('Chunked upload processing failed: ' + error.message));
                    }
                };
                
                reader.onerror = () => reject(new Error('FileReader error in chunked upload'));
                reader.readAsDataURL(file);
            });
        }
        
        // Method 2: Direct Upload (original method with improvements)
        function uploadViaDirectUpload(file, workerId) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    try {
                        const base64Data = e.target.result.split(',')[1];
                        const callbackName = 'photo_direct_' + Date.now() + '_' + Math.round(100000 * Math.random());
                        
                        console.log('üì§ Direct upload via JSONP callback:', callbackName);
                        
                        const script = document.createElement('script');
                        script.id = `photo_script_${callbackName}`;
                        
                        // Use POST-like data in URL (limited but more reliable)
                        const uploadData = {
                            action: 'uploadPhoto',
                            workerId: String(workerId),
                            fileName: `${workerId}_${Date.now()}.${file.name.split('.').pop()}`,
                            fileType: file.type,
                            fileSize: String(file.size),
                            fileData: base64Data.substring(0, 8000), // Limit data size for URL
                            callback: callbackName,
                            timestamp: Date.now(),
                            method: 'direct'
                        };
                        
                        const params = new URLSearchParams(uploadData);
                        script.src = `${SHEET_URL}?${params.toString()}`;
                        
                        console.log('üì° Direct upload URL length:', script.src.length);
                        
                        window[callbackName] = function(response) {
                            console.log('üì• Direct upload response:', response);
                            cleanup();
                            
                            if (response && response.status === 'success' && response.photoUrl) {
                                resolve(response.photoUrl);
                            } else {
                                reject(new Error(response?.message || 'Direct upload failed'));
                            }
                        };
                        
                        script.onerror = function() {
                            cleanup();
                            reject(new Error('Direct upload script error'));
                        };
                        
                        function cleanup() {
                            try {
                                if (document.getElementById(script.id)) {
                                    document.head.removeChild(script);
                                }
                                delete window[callbackName];
                            } catch (e) {
                                console.warn('Cleanup error:', e);
                            }
                        }
                        
                        document.head.appendChild(script);
                        
                        setTimeout(() => {
                            if (window[callbackName]) {
                                cleanup();
                                reject(new Error('Direct upload timeout'));
                            }
                        }, 15000);
                        
                    } catch (error) {
                        reject(new Error('Direct upload processing failed: ' + error.message));
                    }
                };
                
                reader.onerror = () => reject(new Error('FileReader error in direct upload'));
                reader.readAsDataURL(file);
            });
        }
        
        // Method 3: Form Data Upload (alternative approach)
        function uploadViaFormData(file, workerId) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    try {
                        const base64Data = e.target.result.split(',')[1];
                        const callbackName = 'photo_form_' + Date.now() + '_' + Math.round(100000 * Math.random());
                        
                        console.log('üì§ Form data upload via JSONP callback:', callbackName);
                        
                        // Create a more compact data structure
                        const compactData = {
                            a: 'uploadPhoto', // action
                            w: workerId, // workerId
                            f: `${workerId}.${file.name.split('.').pop()}`, // fileName
                            t: file.type.split('/')[1], // fileType (just extension)
                            s: String(file.size), // fileSize
                            d: base64Data, // fileData
                            c: callbackName, // callback
                            ts: Date.now(), // timestamp
                            m: 'form' // method
                        };
                        
                        const script = document.createElement('script');
                        script.id = `photo_script_${callbackName}`;
                        
                        // Build URL manually to avoid encoding issues
                        let url = SHEET_URL + '?';
                        Object.keys(compactData).forEach((key, index) => {
                            if (index > 0) url += '&';
                            url += key + '=' + encodeURIComponent(compactData[key]);
                        });
                        
                        script.src = url;
                        
                        console.log('üì° Form upload URL length:', script.src.length);
                        
                        window[callbackName] = function(response) {
                            console.log('üì• Form upload response:', response);
                            cleanup();
                            
                            if (response && response.status === 'success' && response.photoUrl) {
                                resolve(response.photoUrl);
                            } else {
                                reject(new Error(response?.message || 'Form upload failed'));
                            }
                        };
                        
                        script.onerror = function() {
                            cleanup();
                            reject(new Error('Form upload script error'));
                        };
                        
                        function cleanup() {
                            try {
                                if (document.getElementById(script.id)) {
                                    document.head.removeChild(script);
                                }
                                delete window[callbackName];
                            } catch (e) {
                                console.warn('Cleanup error:', e);
                            }
                        }
                        
                        document.head.appendChild(script);
                        
                        setTimeout(() => {
                            if (window[callbackName]) {
                                cleanup();
                                reject(new Error('Form upload timeout'));
                            }
                        }, 20000);
                        
                    } catch (error) {
                        reject(new Error('Form upload processing failed: ' + error.message));
                    }
                };
                
                reader.onerror = () => reject(new Error('FileReader error in form upload'));
                reader.readAsDataURL(file);
            });
        }
        
        // Helper function for chunked upload
        async function uploadChunksSequentially(chunks, workerId, file) {
            const totalChunks = chunks.length;
            const uploadId = Date.now();
            
            console.log(`üîÑ Starting chunked upload with ${totalChunks} chunks`);
            
            for (let i = 0; i < totalChunks; i++) {
                try {
                    await uploadSingleChunk(chunks[i], i, totalChunks, uploadId, workerId, file);
                    console.log(`‚úÖ Chunk ${i + 1}/${totalChunks} uploaded successfully`);
                } catch (error) {
                    console.error(`‚ùå Chunk ${i + 1}/${totalChunks} failed:`, error);
                    throw new Error(`Chunk upload failed at ${i + 1}/${totalChunks}: ${error.message}`);
                }
            }
            
            // Finalize upload
            return finalizeChunkedUpload(uploadId, workerId, file);
        }
        
        function uploadSingleChunk(chunkData, chunkIndex, totalChunks, uploadId, workerId, file) {
            return new Promise((resolve, reject) => {
                const callbackName = `chunk_${uploadId}_${chunkIndex}_${Date.now()}`;
                const script = document.createElement('script');
                script.id = `chunk_script_${callbackName}`;
                
                const chunkParams = new URLSearchParams({
                    action: 'uploadChunk',
                    uploadId: uploadId,
                    workerId: workerId,
                    chunkIndex: chunkIndex,
                    totalChunks: totalChunks,
                    chunkData: chunkData,
                    fileName: `${workerId}_${uploadId}.${file.name.split('.').pop()}`,
                    fileType: file.type,
                    callback: callbackName
                });
                
                script.src = `${SHEET_URL}?${chunkParams.toString()}`;
                
                window[callbackName] = function(response) {
                    cleanup();
                    if (response && response.status === 'success') {
                        resolve(response);
                    } else {
                        reject(new Error(response?.message || `Chunk ${chunkIndex} upload failed`));
                    }
                };
                
                script.onerror = function() {
                    cleanup();
                    reject(new Error(`Chunk ${chunkIndex} script error`));
                };
                
                function cleanup() {
                    try {
                        if (document.getElementById(script.id)) {
                            document.head.removeChild(script);
                        }
                        delete window[callbackName];
                    } catch (e) {
                        console.warn('Chunk cleanup error:', e);
                    }
                }
                
                document.head.appendChild(script);
                
                setTimeout(() => {
                    if (window[callbackName]) {
                        cleanup();
                        reject(new Error(`Chunk ${chunkIndex} timeout`));
                    }
                }, 10000);
            });
        }
        
        function finalizeChunkedUpload(uploadId, workerId, file) {
            return new Promise((resolve, reject) => {
                const callbackName = `finalize_${uploadId}_${Date.now()}`;
                const script = document.createElement('script');
                script.id = `finalize_script_${callbackName}`;
                
                const finalizeParams = new URLSearchParams({
                    action: 'finalizeUpload',
                    uploadId: uploadId,
                    workerId: workerId,
                    fileName: `${workerId}_${uploadId}.${file.name.split('.').pop()}`,
                    fileType: file.type,
                    fileSize: file.size,
                    callback: callbackName
                });
                
                script.src = `${SHEET_URL}?${finalizeParams.toString()}`;
                
                window[callbackName] = function(response) {
                    cleanup();
                    if (response && response.status === 'success' && response.photoUrl) {
                        console.log('‚úÖ Chunked upload finalized successfully:', response.photoUrl);
                        resolve(response.photoUrl);
                    } else {
                        reject(new Error(response?.message || 'Finalize upload failed'));
                    }
                };
                
                script.onerror = function() {
                    cleanup();
                    reject(new Error('Finalize script error'));
                };
                
                function cleanup() {
                    try {
                        if (document.getElementById(script.id)) {
                            document.head.removeChild(script);
                        }
                        delete window[callbackName];
                    } catch (e) {
                        console.warn('Finalize cleanup error:', e);
                    }
                }
                
                document.head.appendChild(script);
                
                setTimeout(() => {
                    if (window[callbackName]) {
                        cleanup();
                        reject(new Error('Finalize timeout'));
                    }
                }, 15000);
            });
        }

        // Test Cloudinary connection
        async function testCloudinaryConnection() {
            return new Promise(async (resolve, reject) => {
                try {
                    console.log('üîÑ Testing Cloudinary connection...');
                    
                    // Create a small test image (1x1 pixel PNG)
                    const canvas = document.createElement('canvas');
                    canvas.width = 1;
                    canvas.height = 1;
                    const ctx = canvas.getContext('2d');
                    ctx.fillStyle = '#FF0000';
                    ctx.fillRect(0, 0, 1, 1);
                    
                    canvas.toBlob(async (blob) => {
                        try {
                            const testFile = new File([blob], 'test.png', { type: 'image/png' });
                            console.log('üß™ Test file created for Cloudinary:', testFile.name, testFile.size, 'bytes');
                            
                            // Test upload to Cloudinary
                            const CLOUD_NAME = 'dicxzovzt';
                            const UPLOAD_PRESET = 'getjob002';
                            const CLOUDINARY_URL = `https://api.cloudinary.com/v1_1/${CLOUD_NAME}/image/upload`;
                            
                            const formData = new FormData();
                            formData.append('file', testFile);
                            formData.append('upload_preset', UPLOAD_PRESET);
                            formData.append('public_id', `test/connection_test_${Date.now()}`);
                            formData.append('tags', 'test,connection');
                            
                            const response = await fetch(CLOUDINARY_URL, {
                                method: 'POST',
                                body: formData
                            });
                            
                            if (!response.ok) {
                                throw new Error(`HTTP error! status: ${response.status}`);
                            }
                            
                            const result = await response.json();
                            
                            if (result.secure_url) {
                                console.log('‚úÖ Cloudinary connection test successful:', result.secure_url);
                                resolve({
                                    status: 'success',
                                    message: 'Cloudinary connection successful',
                                    url: result.secure_url,
                                    public_id: result.public_id
                                });
                            } else {
                                console.error('‚ùå No secure_url in Cloudinary response:', result);
                                reject(new Error('Cloudinary connection failed - no URL returned'));
                            }
                            
                        } catch (error) {
                            console.error('‚ùå Cloudinary connection test failed:', error);
                            reject(new Error(`Cloudinary connection failed: ${error.message}`));
                        }
                    }, 'image/png');
                    
                } catch (error) {
                    console.error('‚ùå Cloudinary test setup failed:', error);
                    reject(new Error(`Cloudinary test setup failed: ${error.message}`));
                }
            });
        }

        function sendToGoogleSheetsJSONP(data) {
            return new Promise((resolve, reject) => {
                console.log('Sending data to Google Sheets:', data);
                
                // Create unique callback name
                const callbackName = 'jsonp_callback_' + Date.now() + '_' + Math.round(100000 * Math.random());
                
                // Create script element for JSONP
                const script = document.createElement('script');
                script.id = `jsonp_script_${callbackName}`;
                
                // Prepare data for URL encoding
                const urlParams = new URLSearchParams();
                Object.keys(data).forEach(key => {
                    if (data[key] !== undefined && data[key] !== null) {
                        urlParams.append(key, String(data[key]));
                    }
                });
                urlParams.append('callback', callbackName);
                
                // Build complete URL
                const fullUrl = `${SHEET_URL}?${urlParams.toString()}`;
                console.log('Request URL length:', fullUrl.length);
                
                script.src = fullUrl;
                
                // Set up success callback
                window[callbackName] = function(response) {
                    console.log('JSONP Response received:', response);
                    
                    // Cleanup
                    try {
                        if (document.getElementById(script.id)) {
                            document.head.removeChild(script);
                        }
                    } catch (cleanupError) {
                        console.warn('Script cleanup error:', cleanupError);
                    }
                    delete window[callbackName];
                    
                    // Handle response
                    if (response && response.status === 'success') {
                        console.log('Data saved successfully:', response);
                        resolve(response);
                    } else {
                        console.error('Save failed:', response);
                        reject(new Error(response?.message || '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ'));
                    }
                };
                
                // Handle script loading errors
                script.onerror = function(error) {
                    console.error('JSONP Script loading error:', error);
                    
                    // Cleanup
                    try {
                        if (document.getElementById(script.id)) {
                            document.head.removeChild(script);
                        }
                    } catch (cleanupError) {
                        console.warn('Script cleanup error:', cleanupError);
                    }
                    delete window[callbackName];
                    
                    reject(new Error('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏≠‡∏¥‡∏ô‡πÄ‡∏ó‡∏≠‡∏£‡πå‡πÄ‡∏ô‡πá‡∏ï'));
                };
                
                // Add script to head to trigger request
                document.head.appendChild(script);
                
                // Set timeout (15 seconds for data saving)
                setTimeout(() => {
                    if (window[callbackName]) {
                        console.warn('JSONP Request timeout');
                        
                        // Cleanup on timeout
                        try {
                            if (document.getElementById(script.id)) {
                                document.head.removeChild(script);
                            }
                        } catch (cleanupError) {
                            console.warn('Script cleanup error:', cleanupError);
                        }
                        delete window[callbackName];
                        
                        reject(new Error('‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤‡∏ô‡∏≤‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á'));
                    }
                }, 15000);
            });
        }
        
        // Keep the old function for backward compatibility
        function sendToGoogleSheets(data) {
            return sendToGoogleSheetsJSONP(data);
        }

        async function loadWorkersData() {
            try {
                console.log('Loading workers data from Google Sheets...');
                
                // Show loading indicator if refresh button exists
                const refreshBtn = document.getElementById('refreshBtn');
                if (refreshBtn) {
                    refreshBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...';
                    refreshBtn.disabled = true;
                }
                
                // Load data from Google Sheets
                const response = await loadFromGoogleSheetsJSONP();
                
                if (response && response.status === 'success') {
                    // Check if data exists and is an array
                    if (response.data && Array.isArray(response.data) && response.data.length > 0) {
                        workersData = response.data;
                        console.log(`Loaded ${workersData.length} workers from Google Sheets:`, workersData);
                        
                        // Update worker counter based on existing data
                        const maxId = Math.max(...workersData.map(w => {
                            const idNum = parseInt(w.workerId.replace('W', ''));
                            return isNaN(idNum) ? 0 : idNum;
                        }));
                        workerCounter = maxId + 1;
                    } else {
                        console.log('No workers found in Google Sheets');
                        workersData = [];
                        workerCounter = 1;
                    }
                } else {
                    console.warn('Failed to load data from Google Sheets:', response);
                    workersData = [];
                    workerCounter = 1;
                    
                    // Show error message
                    Swal.fire({
                        icon: 'warning',
                        title: '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ',
                        text: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Google Sheets',
                        timer: 3000,
                        showConfirmButton: false
                    });
                }
                
            } catch (error) {
                console.error('Error loading workers data:', error);
                workersData = [];
                workerCounter = 1;
                
                // Show error message
                Swal.fire({
                    icon: 'error',
                    title: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',
                    text: '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö Google Sheets ‡πÑ‡∏î‡πâ',
                    timer: 3000,
                    showConfirmButton: false
                });
            } finally {
                // Reset refresh button
                const refreshBtn = document.getElementById('refreshBtn');
                if (refreshBtn) {
                    refreshBtn.innerHTML = '<span id="refreshText">‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</span>';
                    refreshBtn.disabled = false;
                }
                
                // Update display
                displayWorkers();
            }
        }
        
        function loadFromGoogleSheetsJSONP() {
            return new Promise((resolve, reject) => {
                console.log('Requesting data from Google Sheets...');
                
                // Create unique callback name
                const callbackName = 'load_callback_' + Date.now() + '_' + Math.round(100000 * Math.random());
                
                // Create script element for JSONP
                const script = document.createElement('script');
                script.id = `load_script_${callbackName}`;
                
                // Build URL for loading data
                const params = new URLSearchParams({
                    action: 'loadWorkers',
                    callback: callbackName,
                    timestamp: Date.now() // Add timestamp to prevent caching
                });
                
                script.src = `${SHEET_URL}?${params.toString()}`;
                
                // Set up success callback
                window[callbackName] = function(response) {
                    console.log('Load response received:', response);
                    
                    // Cleanup
                    try {
                        if (document.getElementById(script.id)) {
                            document.head.removeChild(script);
                        }
                    } catch (cleanupError) {
                        console.warn('Script cleanup error:', cleanupError);
                    }
                    delete window[callbackName];
                    
                    // Handle response
                    if (response && response.status === 'success') {
                        console.log('Data loaded successfully:', response);
                        
                        // Validate and clean data
                        if (response.data && Array.isArray(response.data)) {
                            // Filter out empty or invalid records
                            const validData = response.data.filter(worker => {
                                return worker && 
                                       worker.workerId && 
                                       worker.workerId.trim() !== '' &&
                                       worker.fullName && 
                                       worker.fullName.trim() !== '';
                            });
                            
                            console.log(`Filtered ${validData.length} valid workers from ${response.data.length} total records`);
                            
                            resolve({
                                status: 'success',
                                data: validData,
                                message: response.message
                            });
                        } else {
                            console.log('No valid data array found in response');
                            resolve({ status: 'success', data: [] });
                        }
                    } else {
                        console.warn('Load failed or invalid response:', response);
                        resolve({ status: 'success', data: [] });
                    }
                };
                
                // Handle script loading errors
                script.onerror = function(error) {
                    console.error('Load script error:', error);
                    
                    // Cleanup
                    try {
                        if (document.getElementById(script.id)) {
                            document.head.removeChild(script);
                        }
                    } catch (cleanupError) {
                        console.warn('Script cleanup error:', cleanupError);
                    }
                    delete window[callbackName];
                    
                    // Return empty data instead of rejecting
                    resolve({ status: 'success', data: [] });
                };
                
                // Add script to head to trigger request
                document.head.appendChild(script);
                
                // Set timeout (15 seconds for loading)
                setTimeout(() => {
                    if (window[callbackName]) {
                        console.warn('Load request timeout');
                        
                        // Cleanup on timeout
                        try {
                            if (document.getElementById(script.id)) {
                                document.head.removeChild(script);
                            }
                        } catch (cleanupError) {
                            console.warn('Script cleanup error:', cleanupError);
                        }
                        delete window[callbackName];
                        
                        // Return empty data instead of rejecting
                        resolve({ status: 'success', data: [] });
                    }
                }, 15000);
            });
        }

        function displayWorkers() {
            const container = document.getElementById('workersContainer');
            container.innerHTML = '';
            
            const filteredWorkers = getFilteredWorkers();
            
            if (filteredWorkers.length === 0) {
                container.innerHTML = '<div class="col-span-full text-center py-8 text-gray-500">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</div>';
                return;
            }
            
            filteredWorkers.forEach(worker => {
                const firstName = worker.fullName.split(' ')[0];
                const workerCard = document.createElement('div');
                workerCard.className = 'bg-white rounded-lg shadow-md p-6 card-hover transition-all duration-300 cursor-pointer';
                workerCard.onclick = () => showWorkerDetail(worker);
                
                // Enhanced photo display with loading states and better error handling
                let photoElement;
                if (worker.photoUrl && worker.photoUrl.trim() !== '' && worker.photoUrl !== 'undefined' && worker.photoUrl !== 'null') {
                    console.log('üñºÔ∏è Displaying photo for worker:', worker.workerId, 'URL:', worker.photoUrl);
                    
                    // Use Cloudinary URL directly (no conversion needed)
                    const directUrl = worker.photoUrl;
                    
                    photoElement = `
                        <div class="w-20 h-20 mx-auto mb-3 relative">
                            <div class="w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center absolute top-0 left-0 animate-pulse">
                                <div class="w-8 h-8 bg-gray-300 rounded-full"></div>
                            </div>
                            <img src="${directUrl}" 
                                 class="w-20 h-20 object-cover rounded-full border-2 border-primary relative z-10" 
                                 onerror="console.error('‚ùå Image load failed for ${worker.workerId}:', this.src); this.style.display='none'; this.nextElementSibling.style.display='flex';"
                                 onload="console.log('‚úÖ Image loaded for ${worker.workerId}'); this.previousElementSibling.style.display='none'; this.nextElementSibling.style.display='none';">
                            <div class="w-20 h-20 bg-gradient-to-br from-gray-200 to-gray-300 rounded-full flex items-center justify-center text-2xl absolute top-0 left-0 z-10" style="display: none;">
                                <span class="text-gray-500">üë§</span>
                            </div>
                        </div>`;
                } else {
                    console.log('üì∑ No photo URL for worker:', worker.workerId, 'photoUrl:', worker.photoUrl);
                    photoElement = `
                        <div class="w-20 h-20 bg-gradient-to-br from-gray-200 to-gray-300 rounded-full mx-auto mb-3 flex items-center justify-center text-2xl shadow-inner">
                            <span class="text-gray-500">üë§</span>
                        </div>`;
                }
                
                workerCard.innerHTML = `
                    <div class="text-center mb-4">
                        ${photoElement}
                        <h3 class="text-lg font-semibold text-primary">${firstName}</h3>
                        <p class="text-sm text-gray-600">${worker.workerId}</p>
                    </div>
                    
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span class="text-gray-600">‡∏≠‡∏≤‡∏¢‡∏∏:</span>
                            <span>${worker.age} ‡∏õ‡∏µ</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">‡πÄ‡∏û‡∏®:</span>
                            <span>${worker.gender}</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</span>
                            <span class="px-2 py-1 rounded text-xs ${worker.workStatus === '‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}">${worker.workStatus}</span>
                        </div>
                        <div class="mt-3">
                            <span class="text-gray-600 text-xs">‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÑ‡∏î‡πâ:</span>
                            <p class="text-xs mt-1 text-gray-800">${worker.skills}</p>
                        </div>
                    </div>
                    
                    <button class="w-full mt-4 bg-primary text-white py-2 rounded-lg hover-primary transition-colors text-sm">
                        ‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î
                    </button>
                `;
                
                container.appendChild(workerCard);
            });
        }

        function getFilteredWorkers() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const genderFilter = document.getElementById('genderFilter').value;
            const statusFilter = document.getElementById('statusFilter').value;
            
            return workersData.filter(worker => {
                const matchesSearch = !searchTerm || 
                    worker.fullName.toLowerCase().includes(searchTerm) ||
                    worker.workerId.toLowerCase().includes(searchTerm) ||
                    worker.skills.toLowerCase().includes(searchTerm);
                
                const matchesGender = !genderFilter || worker.gender === genderFilter;
                const matchesStatus = !statusFilter || worker.workStatus === statusFilter;
                
                return matchesSearch && matchesGender && matchesStatus;
            });
        }

        function filterWorkers() {
            displayWorkers();
        }

        function editWorker(workerId) {
            const worker = workersData.find(w => w.workerId === workerId);
            if (!worker) return;
            
            // Populate form with worker data
            document.getElementById('fullName').value = worker.fullName;
            document.getElementById('age').value = worker.age;
            document.getElementById('address').value = worker.address;
            document.getElementById('phone').value = worker.phone;
            document.getElementById('lineId').value = worker.lineId;
            document.getElementById('facebook').value = worker.facebook;
            document.getElementById('gender').value = worker.gender;
            document.getElementById('experience').value = worker.experience;
            document.getElementById('transport').value = worker.transport;
            document.getElementById('workStatus').value = worker.workStatus;
            document.getElementById('startDate').value = worker.startDate;
            document.getElementById('idType').value = worker.idType;
            document.getElementById('health').value = worker.health;
            
            // Show form
            showWorkerForm();
            document.getElementById('formTitle').textContent = '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å';
        }

        function deleteWorker(workerId) {
            Swal.fire({
                title: '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö',
                text: '‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?',
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#d33',
                cancelButtonColor: '#3085d6',
                confirmButtonText: '‡∏•‡∏ö',
                cancelButtonText: '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å'
            }).then((result) => {
                if (result.isConfirmed) {
                    // Remove from local data only (not from Google Sheets)
                    workersData = workersData.filter(w => w.workerId !== workerId);
                    displayWorkers();
                    loadAdminWorkersList();
                    
                    Swal.fire({
                        icon: 'success',
                        title: '‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',
                        text: '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏π‡∏Å‡∏•‡∏ö‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÅ‡∏•‡πâ‡∏ß',
                        timer: 2000,
                        showConfirmButton: false
                    });
                }
            });
        }

        // Enhanced Question Editor Functions
        let currentEditingQuestion = null;
        let formEditLanguage = 'th';

        function showQuestionEditor(questionIndex = null) {
            currentEditingQuestion = questionIndex;
            const modal = document.getElementById('questionEditorModal');
            const form = document.getElementById('questionEditorForm');
            
            // Reset form
            form.reset();
            document.getElementById('questionOptions').classList.add('hidden');
            document.getElementById('optionsList').innerHTML = '';
            
            if (questionIndex !== null) {
                // Edit existing question
                const question = formFields[questionIndex];
                document.getElementById('questionThai').value = question.label.th;
                document.getElementById('questionChinese').value = question.label.zh;
                document.getElementById('questionType').value = question.type;
                document.getElementById('questionRequired').checked = question.required;
                
                // Load options if applicable
                if (question.options) {
                    handleQuestionTypeChange();
                    question.options.forEach(option => {
                        addQuestionOption(option);
                    });
                }
                
                document.getElementById('questionEditorTitle').textContent = '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°';
            } else {
                document.getElementById('questionEditorTitle').textContent = '‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÉ‡∏´‡∏°‡πà';
            }
            
            modal.classList.remove('hidden');
        }

        function hideQuestionEditor() {
            document.getElementById('questionEditorModal').classList.add('hidden');
            currentEditingQuestion = null;
        }

        function handleQuestionTypeChange() {
            const type = document.getElementById('questionType').value;
            const optionsDiv = document.getElementById('questionOptions');
            
            if (['select', 'checkbox', 'radio'].includes(type)) {
                optionsDiv.classList.remove('hidden');
                if (document.getElementById('optionsList').children.length === 0) {
                    addQuestionOption();
                }
            } else {
                optionsDiv.classList.add('hidden');
            }
        }

        function addQuestionOption(existingOption = null) {
            const optionsList = document.getElementById('optionsList');
            const optionIndex = optionsList.children.length;
            
            const optionDiv = document.createElement('div');
            optionDiv.className = 'flex items-center space-x-2 bg-gray-50 p-3 rounded-lg';
            optionDiv.innerHTML = `
                <div class="flex-1 grid grid-cols-2 gap-2">
                    <input type="text" placeholder="‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å (‡πÑ‡∏ó‡∏¢)" class="option-th border border-gray-300 rounded px-3 py-2 text-sm" value="${existingOption ? existingOption.label.th : ''}">
                    <input type="text" placeholder="‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å (‡∏à‡∏µ‡∏ô)" class="option-zh border border-gray-300 rounded px-3 py-2 text-sm" value="${existingOption ? existingOption.label.zh : ''}">
                </div>
                <button type="button" onclick="removeQuestionOption(this)" class="bg-red-500 text-white px-3 py-2 rounded text-sm hover:bg-red-600">
                    ‡∏•‡∏ö
                </button>
            `;
            
            optionsList.appendChild(optionDiv);
        }

        function removeQuestionOption(button) {
            button.parentElement.remove();
        }

        function handleQuestionSave(event) {
            event.preventDefault();
            
            const questionData = {
                id: currentEditingQuestion !== null ? formFields[currentEditingQuestion].id : `question_${Date.now()}`,
                type: document.getElementById('questionType').value,
                required: document.getElementById('questionRequired').checked,
                label: {
                    th: document.getElementById('questionThai').value,
                    zh: document.getElementById('questionChinese').value
                }
            };
            
            // Collect options if applicable
            if (['select', 'checkbox', 'radio'].includes(questionData.type)) {
                const options = [];
                const optionElements = document.querySelectorAll('#optionsList > div');
                
                optionElements.forEach(optionDiv => {
                    const thInput = optionDiv.querySelector('.option-th');
                    const zhInput = optionDiv.querySelector('.option-zh');
                    
                    if (thInput.value.trim() && zhInput.value.trim()) {
                        options.push({
                            value: thInput.value.trim(),
                            label: {
                                th: thInput.value.trim(),
                                zh: zhInput.value.trim()
                            }
                        });
                    }
                });
                
                if (options.length > 0) {
                    questionData.options = options;
                }
            }
            
            // Save question
            if (currentEditingQuestion !== null) {
                formFields[currentEditingQuestion] = questionData;
            } else {
                formFields.push(questionData);
            }
            
            // Refresh form fields list
            loadFormFieldsList();
            hideQuestionEditor();
            
            Swal.fire({
                icon: 'success',
                title: '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',
                timer: 1500,
                showConfirmButton: false
            });
        }

        function setFormEditLanguage(language) {
            formEditLanguage = language;
            
            // Update button states
            const thaiBtn = document.getElementById('editFormThai');
            const chineseBtn = document.getElementById('editFormChinese');
            
            if (language === 'th') {
                thaiBtn.classList.add('bg-blue-600');
                thaiBtn.classList.remove('bg-blue-500');
                chineseBtn.classList.add('bg-red-500');
                chineseBtn.classList.remove('bg-red-600');
            } else {
                chineseBtn.classList.add('bg-red-600');
                chineseBtn.classList.remove('bg-red-500');
                thaiBtn.classList.add('bg-blue-500');
                thaiBtn.classList.remove('bg-blue-600');
            }
            
            // Refresh form fields list with selected language
            loadFormFieldsList();
        }

        // Additional event listeners for form management
        document.addEventListener('click', function(e) {
            if (e.target.id === 'previewFormBtn') {
                previewForm();
            } else if (e.target.id === 'editThaiBtn') {
                editContent('th');
            } else if (e.target.id === 'editChineseBtn') {
                editContent('zh');
            } else if (e.target.id === 'saveContentBtn') {
                saveContentChanges();
            } else if (e.target.id === 'importQuestionsBtn') {
                importQuestions();
            } else if (e.target.id === 'exportQuestionsBtn') {
                exportQuestions();
            }
        });

        function importQuestions() {
            Swal.fire({
                title: '‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°',
                html: `
                    <div class="text-left">
                        <p class="mb-4 text-gray-600">‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå JSON ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤</p>
                        <input type="file" id="importFile" accept=".json" class="w-full border border-gray-300 rounded-lg px-4 py-2">
                    </div>
                `,
                showCancelButton: true,
                confirmButtonText: '‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤',
                cancelButtonText: '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å',
                preConfirm: () => {
                    const file = document.getElementById('importFile').files[0];
                    if (!file) {
                        Swal.showValidationMessage('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå');
                        return false;
                    }
                    return file;
                }
            }).then((result) => {
                if (result.isConfirmed) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        try {
                            const importedQuestions = JSON.parse(e.target.result);
                            formFields = [...formFields, ...importedQuestions];
                            loadFormFieldsList();
                            
                            Swal.fire({
                                icon: 'success',
                                title: '‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',
                                text: `‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° ${importedQuestions.length} ‡∏Ç‡πâ‡∏≠`,
                                timer: 2000,
                                showConfirmButton: false
                            });
                        } catch (error) {
                            Swal.fire({
                                icon: 'error',
                                title: '‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á',
                                text: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÑ‡∏ü‡∏•‡πå JSON'
                            });
                        }
                    };
                    reader.readAsText(result.value);
                }
            });
        }

        function exportQuestions() {
            const dataStr = JSON.stringify(formFields, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = `form_questions_${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            
            Swal.fire({
                icon: 'success',
                title: '‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',
                text: '‡πÑ‡∏ü‡∏•‡πå‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏•‡πâ‡∏ß',
                timer: 2000,
                showConfirmButton: false
            });
        }

        function exportToExcel() {
            // Create CSV content
            const headers = ['‡∏£‡∏´‡∏±‡∏™‡∏á‡∏≤‡∏ô', '‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•', '‡∏≠‡∏≤‡∏¢‡∏∏', '‡πÄ‡∏û‡∏®', '‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£', '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞', '‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÑ‡∏î‡πâ', '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å'];
            const csvContent = [
                headers.join(','),
                ...workersData.map(worker => [
                    worker.workerId,
                    `"${worker.fullName}"`,
                    worker.age,
                    worker.gender,
                    worker.phone,
                    worker.workStatus,
                    `"${worker.skills}"`,
                    new Date(worker.timestamp).toLocaleDateString('th-TH')
                ].join(','))
            ].join('\n');
            
            // Create and download file
            const blob = new Blob(['\ufeff' + csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `workers_data_${new Date().toISOString().split('T')[0]}.csv`;
            link.click();
            
            Swal.fire({
                icon: 'success',
                title: 'Export ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',
                text: '‡πÑ‡∏ü‡∏•‡πå‡∏ñ‡∏π‡∏Å‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏•‡πâ‡∏ß',
                timer: 2000,
                showConfirmButton: false
            });
        }

        function resetSheet() {
            Swal.fire({
                title: '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£ Reset',
                text: '‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà? ‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏î‡πâ',
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#d33',
                cancelButtonColor: '#3085d6',
                confirmButtonText: 'Reset',
                cancelButtonText: '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å'
            }).then((result) => {
                if (result.isConfirmed) {
                    workersData = [];
                    workerCounter = 1;
                    displayWorkers();
                    loadAdminDashboard();
                    
                    Swal.fire({
                        icon: 'success',
                        title: 'Reset ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',
                        text: '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ñ‡∏π‡∏Å‡∏•‡∏ö‡πÅ‡∏•‡πâ‡∏ß',
                        timer: 2000,
                        showConfirmButton: false
                    });
                }
            });
        }
        
        // Photo upload test function with image preview
        async function runPhotoUploadTest() {
            Swal.fire({
                title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û',
                html: `
                    <div class="text-center">
                        <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-orange-500 mb-4"></div>
                        <p class="text-gray-600">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà...</p>
                        <div id="testProgress" class="mt-4 text-sm text-gray-500">
                            ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö...
                        </div>
                        <div id="testImagePreview" class="mt-4 hidden">
                            <p class="text-sm text-gray-600 mb-2">‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏ó‡∏î‡∏™‡∏≠‡∏ö:</p>
                            <img id="testImage" class="w-32 h-32 object-cover rounded-lg border mx-auto" alt="Test Image">
                        </div>
                    </div>
                `,
                allowOutsideClick: false,
                showConfirmButton: false
            });
            
            try {
                // Update progress
                document.getElementById('testProgress').textContent = '‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏î‡∏™‡∏≠‡∏ö...';
                
                const testResult = await testPhotoUpload();
                
                document.getElementById('testProgress').textContent = '‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå...';
                
                // Show test image if URL is valid
                if (testResult && testResult.trim() !== '') {
                    document.getElementById('testProgress').textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û...';
                    const testImage = document.getElementById('testImage');
                    const testImagePreview = document.getElementById('testImagePreview');
                    
                    // Convert Google Drive URL to direct view format
                    let directUrl = testResult;
                    if (testResult.includes('drive.google.com/file/d/')) {
                        const fileId = testResult.match(/\/file\/d\/([a-zA-Z0-9_-]+)/);
                        if (fileId && fileId[1]) {
                            directUrl = `https://drive.google.com/uc?export=view&id=${fileId[1]}`;
                            console.log('üîÑ Converted test URL to direct format:', directUrl);
                        }
                    }
                    
                    testImage.onload = function() {
                        console.log('‚úÖ Test image loaded successfully');
                        testImagePreview.classList.remove('hidden');
                        document.getElementById('testProgress').textContent = '‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!';
                    };
                    
                    testImage.onerror = function() {
                        console.warn('‚ö†Ô∏è Test image failed to load');
                        document.getElementById('testProgress').textContent = '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÑ‡∏î‡πâ';
                    };
                    
                    testImage.src = directUrl;
                }
                
                setTimeout(() => {
                    if (testResult && testResult.trim() !== '') {
                        Swal.fire({
                            icon: 'success',
                            title: '‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‚úÖ',
                            html: `
                                <div class="text-left space-y-4">
                                    <div class="bg-green-50 p-4 rounded-lg">
                                        <p class="text-green-800 font-semibold mb-2">üéâ ‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥!</p>
                                        <div class="text-sm text-green-700">
                                            <p><strong>URL ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö:</strong></p>
                                            <p class="break-all bg-green-100 p-2 rounded mt-1">${testResult}</p>
                                        </div>
                                    </div>
                                    
                                    <div class="text-center my-4">
                                        <p class="text-sm text-gray-600 mb-2">‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏ó‡∏î‡∏™‡∏≠‡∏ö:</p>
                                        <img src="${testResult.includes('drive.google.com/file/d/') ? `https://drive.google.com/uc?export=view&id=${testResult.match(/\/file\/d\/([a-zA-Z0-9_-]+)/)?.[1]}` : testResult}" class="w-32 h-32 object-cover rounded-lg border mx-auto shadow-lg" 
                                             onerror="this.style.display='none'; this.nextElementSibling.style.display='block';"
                                             onload="this.nextElementSibling.style.display='none';">
                                        <div class="w-32 h-32 bg-gray-200 rounded-lg mx-auto flex items-center justify-center text-gray-500" style="display: none;">
                                            <span>‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏π‡∏õ‡πÑ‡∏î‡πâ</span>
                                        </div>
                                    </div>
                                    
                                    <div class="bg-blue-50 p-4 rounded-lg">
                                        <p class="text-blue-800 font-semibold mb-2">üìä ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö:</p>
                                        <ul class="text-sm text-blue-700 space-y-1">
                                            <li>‚úÖ ‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏î‡∏™‡∏≠‡∏ö: ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</li>
                                            <li>‚úÖ ‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏õ Google Drive: ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</li>
                                            <li>‚úÖ ‡∏Å‡∏≤‡∏£‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö URL: ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</li>
                                            <li>‚úÖ ‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û: ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</li>
                                            <li>‚úÖ ‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</li>
                                        </ul>
                                    </div>
                                </div>
                            `,
                            confirmButtonText: '‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°!',
                            confirmButtonColor: '#10b981',
                            width: '600px'
                        });
                    } else {
                        Swal.fire({
                            icon: 'error',
                            title: '‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß ‚ùå',
                            html: `
                                <div class="text-left space-y-4">
                                    <div class="bg-red-50 p-4 rounded-lg">
                                        <p class="text-red-800 font-semibold mb-2">üö´ ‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤</p>
                                        <p class="text-sm text-red-700">‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö URL ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö</p>
                                    </div>
                                    
                                    <div class="bg-yellow-50 p-4 rounded-lg">
                                        <p class="text-yellow-800 font-semibold mb-2">üîß ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:</p>
                                        <ul class="text-sm text-yellow-700 space-y-1">
                                            <li>‚Ä¢ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Google Apps Script URL</li>
                                            <li>‚Ä¢ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á Google Drive</li>
                                            <li>‚Ä¢ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Folder ID ‡πÉ‡∏ô Google Drive</li>
                                            <li>‚Ä¢ ‡∏•‡∏≠‡∏á‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</li>
                                        </ul>
                                    </div>
                                    
                                    <div class="bg-gray-50 p-4 rounded-lg">
                                        <p class="text-gray-800 font-semibold mb-2">üîç ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö:</p>
                                        <p class="text-sm text-gray-600">‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå: ${testResult || 'null/undefined'}</p>
                                    </div>
                                </div>
                            `,
                            confirmButtonText: '‡∏õ‡∏¥‡∏î',
                            confirmButtonColor: '#ef4444'
                        });
                    }
                }, 2000);
                
            } catch (error) {
                console.error('Test upload error:', error);
                
                Swal.fire({
                    icon: 'error',
                    title: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö ‚ö†Ô∏è',
                    html: `
                        <div class="text-left space-y-4">
                            <div class="bg-red-50 p-4 rounded-lg">
                                <p class="text-red-800 font-semibold mb-2">‚ùå ‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î:</p>
                                <p class="text-sm text-red-700">${error.message}</p>
                            </div>
                            
                            <div class="bg-blue-50 p-4 rounded-lg">
                                <p class="text-blue-800 font-semibold mb-2">üí° ‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:</p>
                                <ul class="text-sm text-blue-700 space-y-1">
                                    <li>‚Ä¢ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏≠‡∏¥‡∏ô‡πÄ‡∏ó‡∏≠‡∏£‡πå‡πÄ‡∏ô‡πá‡∏ï</li>
                                    <li>‚Ä¢ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Console ‡πÉ‡∏ô Developer Tools</li>
                                    <li>‚Ä¢ ‡∏•‡∏≠‡∏á‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö</li>
                                    <li>‚Ä¢ ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö</li>
                                </ul>
                            </div>
                        </div>
                    `,
                    confirmButtonText: '‡∏õ‡∏¥‡∏î',
                    confirmButtonColor: '#ef4444'
                });
            }
        }

        // Form Management Functions
        function showFormManagement() {
            document.getElementById('formManagementModal').classList.remove('hidden');
            loadFormFieldsList();
        }

        function hideFormManagement() {
            document.getElementById('formManagementModal').classList.add('hidden');
        }

        function loadFormFieldsList() {
            const container = document.getElementById('formFieldsList');
            container.innerHTML = '';

            if (formFields.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-12 text-gray-500">
                        <div class="text-6xl mb-4">üìù</div>
                        <h3 class="text-lg font-medium mb-2">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÉ‡∏ô‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°</h3>
                        <p class="text-sm">‡∏Ñ‡∏•‡∏¥‡∏Å "‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÉ‡∏´‡∏°‡πà" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°</p>
                    </div>
                `;
                return;
            }

            formFields.forEach((field, index) => {
                const fieldDiv = document.createElement('div');
                fieldDiv.className = 'bg-white border-2 border-gray-200 p-6 rounded-xl shadow-sm hover:shadow-md transition-all duration-300';
                
                const typeIcons = {
                    'text': 'üìù',
                    'textarea': 'üìÑ',
                    'number': 'üî¢',
                    'date': 'üìÖ',
                    'select': 'üìã',
                    'checkbox': '‚òëÔ∏è',
                    'radio': 'üîò',
                    'file': 'üìé'
                };
                
                fieldDiv.innerHTML = `
                    <div class="flex justify-between items-start">
                        <div class="flex-1">
                            <div class="flex items-center space-x-3 mb-3">
                                <span class="text-2xl">${typeIcons[field.type] || '‚ùì'}</span>
                                <div>
                                    <h4 class="font-semibold text-lg text-gray-800">
                                        ${field.label[formEditLanguage]} 
                                        ${field.required ? '<span class="text-red-500">*</span>' : ''}
                                    </h4>
                                    <p class="text-sm text-gray-500">ID: ${field.id}</p>
                                </div>
                            </div>
                            
                            <div class="flex flex-wrap gap-2 mb-3">
                                <span class="px-3 py-1 bg-blue-100 text-blue-800 text-xs rounded-full font-medium">
                                    ${field.type}
                                </span>
                                ${field.required ? 
                                    '<span class="px-3 py-1 bg-red-100 text-red-800 text-xs rounded-full font-medium">‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô</span>' : 
                                    '<span class="px-3 py-1 bg-gray-100 text-gray-600 text-xs rounded-full font-medium">‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô</span>'
                                }
                                ${field.options ? 
                                    `<span class="px-3 py-1 bg-green-100 text-green-800 text-xs rounded-full font-medium">${field.options.length} ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</span>` : 
                                    ''
                                }
                            </div>
                            
                            ${field.options ? `
                                <div class="mt-2">
                                    <p class="text-xs text-gray-600 mb-1">‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å:</p>
                                    <div class="flex flex-wrap gap-1">
                                        ${field.options.slice(0, 3).map(option => 
                                            `<span class="px-2 py-1 bg-gray-50 text-gray-700 text-xs rounded border">${option.label[formEditLanguage]}</span>`
                                        ).join('')}
                                        ${field.options.length > 3 ? `<span class="px-2 py-1 text-gray-500 text-xs">+${field.options.length - 3} ‡∏≠‡∏∑‡πà‡∏ô‡πÜ</span>` : ''}
                                    </div>
                                </div>
                            ` : ''}
                        </div>
                        
                        <div class="flex flex-col space-y-2 ml-4">
                            <button onclick="showQuestionEditor(${index})" class="bg-gradient-to-r from-blue-500 to-blue-600 text-white px-4 py-2 rounded-lg text-sm hover:from-blue-600 hover:to-blue-700 transition-all duration-300 flex items-center space-x-1">
                                <span>‚úèÔ∏è</span>
                                <span>‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</span>
                            </button>
                            
                            <div class="flex space-x-1">
                                <button onclick="moveFieldUp(${index})" class="bg-gray-500 text-white px-3 py-2 rounded-lg text-sm hover:bg-gray-600 transition-colors ${index === 0 ? 'opacity-50 cursor-not-allowed' : ''}" ${index === 0 ? 'disabled' : ''}>
                                    ‚Üë
                                </button>
                                <button onclick="moveFieldDown(${index})" class="bg-gray-500 text-white px-3 py-2 rounded-lg text-sm hover:bg-gray-600 transition-colors ${index === formFields.length - 1 ? 'opacity-50 cursor-not-allowed' : ''}" ${index === formFields.length - 1 ? 'disabled' : ''}>
                                    ‚Üì
                                </button>
                            </div>
                            
                            <button onclick="deleteField(${index})" class="bg-gradient-to-r from-red-500 to-red-600 text-white px-4 py-2 rounded-lg text-sm hover:from-red-600 hover:to-red-700 transition-all duration-300 flex items-center space-x-1">
                                <span>üóëÔ∏è</span>
                                <span>‡∏•‡∏ö</span>
                            </button>
                        </div>
                    </div>
                `;
                container.appendChild(fieldDiv);
            });
        }

        function addNewField() {
            Swal.fire({
                title: '‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ü‡∏¥‡∏•‡∏î‡πå‡πÉ‡∏´‡∏°‡πà',
                html: `
                    <div class="space-y-4 text-left">
                        <div>
                            <label class="block text-sm font-medium mb-1">ID ‡∏ü‡∏¥‡∏•‡∏î‡πå:</label>
                            <input type="text" id="newFieldId" class="w-full border rounded px-3 py-2" placeholder="‡πÄ‡∏ä‡πà‡∏ô newField">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ü‡∏¥‡∏•‡∏î‡πå:</label>
                            <select id="newFieldType" class="w-full border rounded px-3 py-2">
                                <option value="text">‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</option>
                                <option value="textarea">‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏•‡∏≤‡∏¢‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î</option>
                                <option value="number">‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç</option>
                                <option value="date">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</option>
                                <option value="select">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏î‡∏µ‡∏¢‡∏ß</option>
                                <option value="checkbox">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏•‡∏≤‡∏¢‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</option>
                                <option value="file">‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1">‡∏ä‡∏∑‡πà‡∏≠‡∏ü‡∏¥‡∏•‡∏î‡πå (‡πÑ‡∏ó‡∏¢):</label>
                            <input type="text" id="newFieldLabelTh" class="w-full border rounded px-3 py-2" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1">‡∏ä‡∏∑‡πà‡∏≠‡∏ü‡∏¥‡∏•‡∏î‡πå (‡∏à‡∏µ‡∏ô):</label>
                            <input type="text" id="newFieldLabelZh" class="w-full border rounded px-3 py-2" placeholder="‡πÄ‡∏ä‡πà‡∏ô Êñ∞Ë≥áÊñô">
                        </div>
                        <div>
                            <label class="flex items-center">
                                <input type="checkbox" id="newFieldRequired" class="mr-2">
                                ‡∏ü‡∏¥‡∏•‡∏î‡πå‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô
                            </label>
                        </div>
                    </div>
                `,
                showCancelButton: true,
                confirmButtonText: '‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ü‡∏¥‡∏•‡∏î‡πå',
                cancelButtonText: '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å',
                preConfirm: () => {
                    const id = document.getElementById('newFieldId').value;
                    const type = document.getElementById('newFieldType').value;
                    const labelTh = document.getElementById('newFieldLabelTh').value;
                    const labelZh = document.getElementById('newFieldLabelZh').value;
                    const required = document.getElementById('newFieldRequired').checked;

                    if (!id || !labelTh || !labelZh) {
                        Swal.showValidationMessage('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô');
                        return false;
                    }

                    return { id, type, labelTh, labelZh, required };
                }
            }).then((result) => {
                if (result.isConfirmed) {
                    const newField = {
                        id: result.value.id,
                        type: result.value.type,
                        required: result.value.required,
                        label: {
                            th: result.value.labelTh,
                            zh: result.value.labelZh
                        }
                    };

                    if (result.value.type === 'select' || result.value.type === 'checkbox') {
                        newField.options = [
                            { value: '‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å1', label: { th: '‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å1', zh: 'ÈÅ∏È†Ö1' } }
                        ];
                    }

                    formFields.push(newField);
                    loadFormFieldsList();
                    
                    Swal.fire({
                        icon: 'success',
                        title: '‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ü‡∏¥‡∏•‡∏î‡πå‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',
                        timer: 1500,
                        showConfirmButton: false
                    });
                }
            });
        }

        function editField(index) {
            const field = formFields[index];
            
            Swal.fire({
                title: '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ü‡∏¥‡∏•‡∏î‡πå',
                html: `
                    <div class="space-y-4 text-left">
                        <div>
                            <label class="block text-sm font-medium mb-1">ID ‡∏ü‡∏¥‡∏•‡∏î‡πå:</label>
                            <input type="text" id="editFieldId" class="w-full border rounded px-3 py-2" value="${field.id}">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1">‡∏ä‡∏∑‡πà‡∏≠‡∏ü‡∏¥‡∏•‡∏î‡πå (‡πÑ‡∏ó‡∏¢):</label>
                            <input type="text" id="editFieldLabelTh" class="w-full border rounded px-3 py-2" value="${field.label.th}">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1">‡∏ä‡∏∑‡πà‡∏≠‡∏ü‡∏¥‡∏•‡∏î‡πå (‡∏à‡∏µ‡∏ô):</label>
                            <input type="text" id="editFieldLabelZh" class="w-full border rounded px-3 py-2" value="${field.label.zh}">
                        </div>
                        <div>
                            <label class="flex items-center">
                                <input type="checkbox" id="editFieldRequired" class="mr-2" ${field.required ? 'checked' : ''}>
                                ‡∏ü‡∏¥‡∏•‡∏î‡πå‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô
                            </label>
                        </div>
                    </div>
                `,
                showCancelButton: true,
                confirmButtonText: '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å',
                cancelButtonText: '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å',
                preConfirm: () => {
                    const id = document.getElementById('editFieldId').value;
                    const labelTh = document.getElementById('editFieldLabelTh').value;
                    const labelZh = document.getElementById('editFieldLabelZh').value;
                    const required = document.getElementById('editFieldRequired').checked;

                    if (!id || !labelTh || !labelZh) {
                        Swal.showValidationMessage('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô');
                        return false;
                    }

                    return { id, labelTh, labelZh, required };
                }
            }).then((result) => {
                if (result.isConfirmed) {
                    formFields[index].id = result.value.id;
                    formFields[index].label.th = result.value.labelTh;
                    formFields[index].label.zh = result.value.labelZh;
                    formFields[index].required = result.value.required;
                    
                    loadFormFieldsList();
                    
                    Swal.fire({
                        icon: 'success',
                        title: '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ü‡∏¥‡∏•‡∏î‡πå‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',
                        timer: 1500,
                        showConfirmButton: false
                    });
                }
            });
        }

        function deleteField(index) {
            Swal.fire({
                title: '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö',
                text: `‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏ü‡∏¥‡∏•‡∏î‡πå "${formFields[index].label[currentLanguage]}" ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?`,
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#d33',
                cancelButtonColor: '#3085d6',
                confirmButtonText: '‡∏•‡∏ö',
                cancelButtonText: '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å'
            }).then((result) => {
                if (result.isConfirmed) {
                    formFields.splice(index, 1);
                    loadFormFieldsList();
                    
                    Swal.fire({
                        icon: 'success',
                        title: '‡∏•‡∏ö‡∏ü‡∏¥‡∏•‡∏î‡πå‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',
                        timer: 1500,
                        showConfirmButton: false
                    });
                }
            });
        }

        function moveFieldUp(index) {
            if (index > 0) {
                [formFields[index], formFields[index - 1]] = [formFields[index - 1], formFields[index]];
                loadFormFieldsList();
            }
        }

        function moveFieldDown(index) {
            if (index < formFields.length - 1) {
                [formFields[index], formFields[index + 1]] = [formFields[index + 1], formFields[index]];
                loadFormFieldsList();
            }
        }

        function previewForm() {
            // Generate dynamic form preview
            let formHTML = '<div class="space-y-4">';
            
            formFields.forEach(field => {
                formHTML += `<div class="border-b pb-4">`;
                formHTML += `<label class="block text-sm font-medium text-gray-700 mb-2">
                    ${field.label[currentLanguage]} ${field.required ? '*' : ''}
                </label>`;
                
                switch (field.type) {
                    case 'text':
                    case 'tel':
                        formHTML += `<input type="${field.type}" class="w-full border border-gray-300 rounded-lg px-4 py-2" placeholder="${field.label[currentLanguage]}">`;
                        break;
                    case 'number':
                        formHTML += `<input type="number" class="w-full border border-gray-300 rounded-lg px-4 py-2" ${field.min ? `min="${field.min}"` : ''} ${field.max ? `max="${field.max}"` : ''}>`;
                        break;
                    case 'textarea':
                        formHTML += `<textarea class="w-full border border-gray-300 rounded-lg px-4 py-2" rows="3" placeholder="${field.label[currentLanguage]}"></textarea>`;
                        break;
                    case 'date':
                        formHTML += `<input type="date" class="w-full border border-gray-300 rounded-lg px-4 py-2">`;
                        break;
                    case 'select':
                        formHTML += `<select class="w-full border border-gray-300 rounded-lg px-4 py-2">
                            <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å${field.label[currentLanguage]}</option>`;
                        if (field.options) {
                            field.options.forEach(option => {
                                formHTML += `<option value="${option.value}">${option.label[currentLanguage]}</option>`;
                            });
                        }
                        formHTML += `</select>`;
                        break;
                    case 'checkbox':
                        if (field.options) {
                            formHTML += `<div class="grid grid-cols-2 gap-2">`;
                            field.options.forEach(option => {
                                formHTML += `<label class="flex items-center">
                                    <input type="checkbox" value="${option.value}" class="mr-2">
                                    ${option.label[currentLanguage]}
                                </label>`;
                            });
                            formHTML += `</div>`;
                        }
                        break;
                    case 'file':
                        formHTML += `<input type="file" class="w-full border border-gray-300 rounded-lg px-4 py-2" ${field.accept ? `accept="${field.accept}"` : ''}>`;
                        break;
                }
                formHTML += `</div>`;
            });
            
            formHTML += '</div>';
            
            Swal.fire({
                title: '‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°',
                html: formHTML,
                width: '800px',
                confirmButtonText: '‡∏õ‡∏¥‡∏î'
            });
        }

        // Content Editor Functions
        function showContentEditor() {
            document.getElementById('contentEditorModal').classList.remove('hidden');
        }

        function hideContentEditor() {
            document.getElementById('contentEditorModal').classList.add('hidden');
        }

        function editContent(language) {
            const container = document.getElementById('contentEditor');
            container.innerHTML = '';
            
            const currentTranslations = translations[language];
            
            Object.keys(currentTranslations).forEach(key => {
                const div = document.createElement('div');
                div.className = 'mb-4';
                div.innerHTML = `
                    <label class="block text-sm font-medium text-gray-700 mb-2">${key}:</label>
                    <input type="text" id="content_${key}" class="w-full border border-gray-300 rounded-lg px-4 py-2" value="${currentTranslations[key]}">
                `;
                container.appendChild(div);
            });
            
            // Store current editing language
            container.dataset.editingLanguage = language;
        }

        function saveContentChanges() {
            const container = document.getElementById('contentEditor');
            const editingLanguage = container.dataset.editingLanguage;
            
            if (!editingLanguage) {
                Swal.fire({
                    icon: 'error',
                    title: '‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',
                    text: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏†‡∏≤‡∏©‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Å‡πà‡∏≠‡∏ô'
                });
                return;
            }
            
            // Update translations
            Object.keys(translations[editingLanguage]).forEach(key => {
                const input = document.getElementById(`content_${key}`);
                if (input) {
                    translations[editingLanguage][key] = input.value;
                }
            });
            
            // Update current display if editing current language
            if (editingLanguage === currentLanguage) {
                updateLanguage();
            }
            
            Swal.fire({
                icon: 'success',
                title: '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',
                text: `‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏†‡∏≤‡∏©‡∏≤${editingLanguage === 'th' ? '‡πÑ‡∏ó‡∏¢' : '‡∏à‡∏µ‡∏ô'}‡∏ñ‡∏π‡∏Å‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÅ‡∏•‡πâ‡∏ß`,
                timer: 2000,
                showConfirmButton: false
            });
        }
    </script>
    <!-- LWC PATCH B: Switch photo upload to POST -->
<script>
(function(){
  // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö POST
  async function LWC_uploadPhotoViaPost(file, workerId){
    const base64 = await new Promise((resolve,reject)=>{
      const fr = new FileReader();
      fr.onload = ()=>{
        const s = String(fr.result);
        const i = s.indexOf('base64,');
        resolve(i>-1 ? s.slice(i+7) : s);
      };
      fr.onerror = reject;
      fr.readAsDataURL(file);
    });

    const payload = {
      action   : 'uploadPhoto',
      workerId : workerId,
      fileType : file.type || 'image/jpeg',
      fileData : base64
    };

    const resp = await fetch(SHEET_URL, {
      method: 'POST',
      headers: {'Content-Type':'application/json'},
      body: JSON.stringify(payload)
    });
    if (!resp.ok) throw new Error('HTTP '+resp.status);
    return await resp.json();
  }

  // ‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏î‡∏¥‡∏° ‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å POST ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ
  const __origAdd = window.LWC_addWorkerFromForm;
  window.LWC_addWorkerFromForm = async function(ev){
    if (ev) ev.preventDefault();
    const workerId = 'W' + Date.now();
    window.LWC_lastWorkerId = workerId;

    // ‡∏™‡∏£‡πâ‡∏≤‡∏á payload ‡πÄ‡∏û‡∏¥‡πà‡∏° worker
    const payload = {
      action:'addWorker',
      workerId,
      fullName: document.getElementById('fullName')?.value.trim() || '',
      age: document.getElementById('age')?.value || '',
      address: document.getElementById('address')?.value.trim() || '',
      phone: document.getElementById('phone')?.value.trim() || '',
      lineId: document.getElementById('lineId')?.value.trim() || '',
      facebook: document.getElementById('facebook')?.value.trim() || '',
      gender: document.getElementById('gender')?.value || '',
      experience: document.getElementById('experience')?.value.trim() || '',
      transport: document.getElementById('transport')?.value || '',
      workStatus: document.getElementById('workStatus')?.value || '',
      startDate: document.getElementById('startDate')?.value || '',
      idType: document.getElementById('idType')?.value || '',
      health: document.getElementById('health')?.value.trim() || '',
      interestedJobs: window.LWC_getChecked ? LWC_getChecked('#interestedJobs input[type=checkbox]') : '',
      skills: window.LWC_getChecked ? LWC_getChecked('#skills input[type=checkbox]') : '',
      languages: window.LWC_getChecked ? LWC_getChecked('#languages input[type=checkbox]') : '',
      photoUrl: ''
    };

    // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏° worker ‡πÅ‡∏ö‡∏ö JSONP
    const res = await (window.LWC_jsonpPromise ? LWC_jsonpPromise(SHEET_URL, payload) : Promise.resolve({status:'error'}));

    if (res && res.status === 'success'){
      const file = document.getElementById('photo')?.files?.[0];
      if (file){
        try {
          const r = await LWC_uploadPhotoViaPost(file, workerId);
          if (r.status === 'success'){
            document.getElementById('previewImg').src = r.photoUrl;
            document.getElementById('photoPreview')?.classList.remove('hidden');
          } else {
            console.warn('Upload failed:', r);
          }
        } catch(err){
          console.error('Upload error:', err);
        }
      }
      window.LWC_loadWorkers && LWC_loadWorkers();
      Swal.fire({icon:'success', title:'‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', timer:1200, showConfirmButton:false});
      document.getElementById('workerFormModal').classList.add('hidden');
    } else {
      Swal.fire({icon:'error', title:'‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß', text: res?.message || 'Unknown error'});
    }
  };
})();
</script>
<!-- END PATCH -->

<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96bf29e91091fe13',t:'MTc1NDY1NzY4MS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script>
<!-- LWC PATCH CLOUDINARY: Override upload to use Cloudinary (no UI changes) -->
<script>
(function(){
  // üîß Configure your Cloudinary here
  const CLOUD_NAME   = 'dicxzovzt';     // ‚Üê ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ
  const UPLOAD_PRESET= 'getjob002';     // ‚Üê ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô unsigned preset
  const FOLDER       = 'worker_photos'; // ‚Üê ‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå (‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÉ‡∏™‡πà/‡πÑ‡∏°‡πà‡πÉ‡∏™‡πà‡∏Å‡πá‡πÑ‡∏î‡πâ)

  async function uploadToCloudinary(file, publicId){
    const form = new FormData();
    form.append('file', file);
    form.append('upload_preset', UPLOAD_PRESET);
    if (FOLDER) form.append('folder', FOLDER);
    if (publicId) form.append('public_id', publicId);

    const res = await fetch(`https://api.cloudinary.com/v1_1/${CLOUD_NAME}/image/upload`, {
      method: 'POST',
      body: form
    });
    if (!res.ok) {
      const t = await res.text().catch(()=>'');
      throw new Error('Cloudinary upload failed: HTTP ' + res.status + (t?(' - '+t.slice(0,180)):''));
    }
    const data = await res.json();
    if (!data.secure_url) throw new Error('Cloudinary response missing secure_url');
    return data.secure_url; // ‚úÖ ready-to-use HTTPS URL
  }

  // ‚úÖ Override existing function used during form submit
  //    Keep the same name so the rest of the app works unchanged.
  window.uploadPhotoToGoogleDrive = async function(file, workerId){
    if (!file) throw new Error('‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û');
    if (!workerId) throw new Error('‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏á‡∏≤‡∏ô');
    const allowed = ['image/jpeg','image/jpg','image/png'];
    if (!allowed.includes(file.type)) throw new Error('‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÑ‡∏ü‡∏•‡πå .jpg, .jpeg, .png ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô');
    if (file.size > 2*1024*1024) throw new Error('‡πÑ‡∏ü‡∏•‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÉ‡∏´‡∏ç‡πà‡πÄ‡∏Å‡∏¥‡∏ô 2MB');

    const publicId = `${workerId}_${Date.now()}`;
    const url = await uploadToCloudinary(file, publicId);
    return url; // ‡∏™‡πà‡∏á‡∏Å‡∏•‡∏±‡∏ö‡πÉ‡∏´‡πâ logic ‡πÄ‡∏î‡∏¥‡∏°‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏õ‡πá‡∏ô photoUrl
  };

  console.log('‚úÖ LWC PATCH: uploadPhotoToGoogleDrive ‚Üí Cloudinary (secure_url) is active.');
})();
</script>
</body>
</html>
